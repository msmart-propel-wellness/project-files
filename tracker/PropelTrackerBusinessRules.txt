PropelTracker -- FrontEnd Business Rules
Location of files
    PropelHtml5\App\controllers
    PropelHtml5\App\layout\{folder}

GENERAL
    controllers.js

COMPETITIONS
    controllers.competitions.js
    
    ABOUT (Competitions tab, About button)
        controllers.competitions.about.js
            see PropelHTML5\App\core\locale\en-US\about.js
            see PropelHTML5\App\core\locale\en-US\basedata.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any defaults needed for the view
                other methods
                    activate
                        activate the controller via the common module with controllerId
                activate()
        about.html
        
    ADDINDIVIDUALS
        controllers.competitions.addindividuals.js
        addindividuals.html    
    
    ADDTEAMS
        controllers.competitions.addteams.js
        addteams.html
    
    BADGES
        controllers.competitions.badges.js
        badges.html
    
    DETAIL
        controllers.competitions.detail.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                    apipaging initialization object
                    changePrevious(pgingid)
                        switch on pgingid
                            2:  vm.apipage.subpgcurrent -= 1
                                teamLeaderboardDrilldown(teamid, teamname)
                            3:  vm.apipage.subpgcurrent -= 1
                                groupLeaderboardDrilldown(groupid, groupname)
                            default:    vm.apipage.pgcurrent -= 1
                                        getLeaderboardTally()
                    changeNext(pgingid)
                        switch on pgingid
                            2:  vm.apipage.subpgcurrent += 1
                                teamLeaderboardDrilldown(teamid, teamname)
                            3:  vm.apipage.subpgcurrent += 1
                                groupLeaderboardDrilldown(groupid, groupname)
                            default:    vm.apipage.pgcurrent += 1
                                        getLeaderboardTally()
                    changeStart(pgingid)
                        switch on pgingid
                            2:  vm.apipage.subpgcurrent = 1
                                teamLeaderboardDrilldown(teamid, teamname)
                            3:  vm.apipage.subpgcurrent = 1
                                groupLeaderboardDrilldown(groupid, groupname)
                            default:    vm.apipage.pgcurrent = 1
                                        getLeaderboardTally()
                    changeEnd(pgingid)
                        switch on pgingid
                            2:  vm.apipage.subpgcurrent = vm.apipage.subpgtotal
                                teamLeaderboardDrilldown(teamid, teamname)
                            3:  vm.apipage.subpgcurrent = vm.apipage.subpgtotal
                                groupLeaderboardDrilldown(groupid, groupname)
                            default:    vm.apipage.pgcurrent = vm.apipage.pgtotal
                                        getLeaderboardTally()
                computed values
                    showLeaderboardAmounts
                        return true if competitionDetail.CheckInCategoryID != biometric
                    isEnrollmentCategory(ref)
                        returns true if ref and competitionDetail.EnrollmentCategoryId are of the same type (e.g., ind, team, group)
                    isAccessLevel(ref)
                        returns true if ref and competitionDetail.AccessLevelId are of the same type (e.g., public, private)
                    isCompetitionStatus(ref)
                        returns true if ref and competitionDetail.CompetitionStatusId are of the same type (pending, inprogress, completed)
                    isTallied
                        returns competitionDetail.Tallied
                    isCompPubCanEnroll
                        return competitionDetail.AccessLevelId == public
                            && competitionDetail.CanEnroll
                            && !competitionDetail.IsEntered
                            && competitionDetail.EnrollmentCategoryId != group
                    isCompPriOwner
                        return competitionDetail.AccessLevelId == private
                            && competitionDetail.OwnerUid == app.profile.MemberUid
                    isCompTeamEntered
                        return competitionDetail.EnrollmentCategoryId == team
                            && competitionDetail.IsEntered
                            && !competitionDetail.Tallied
                    isPublicOrPrivateAndEntered
                        can only view leaderoard if (public) or (private and user is entered)
                        return (competitionDetail.AccessLevelId == private && competitionDetail.IsEntered)
                            || competitionDetail.AccessLevelId == public
                    isStartingOnOrAfterToday
                        // Get start date as if it were Anywhere on Earth (UTC -12) to allow any time zone to return true
                        // A stricter check would require getting the time zone setting from the API
                        uses moment library (which is deprecated)
                        return moment
                            .utc(vm.competitiondetail.StartDate)
                            .utcOffset('-12:00', true)
                            .add(1, 'days')
                            .isAfter(moment());
                event handlers (TODO: change text 'event handlers' to 'click handlers')
                    enterCompetition
                        if competitionDetail.EnrollmentCategoryId == team
                            route to CompetitionsParticipation with competitionId
                        else
                            create a request model
                            send a POST request with the request model to the api (insertIndCompEntry)
                            on success
                                set competitionDetail.IsEntered = true
                                show entryConfirmation modal
                    enterCompetitionContinue
                        location.reload()
                    editCompetition
                        route to CompetitionEdit with competitionid
                    sendIndividualInvitations
                        route to CompetitionsAddIndividuals with competitionid
                    sendTeamInvitations
                        route to CompetitionsAddTeams with competitionid
                    manageParticipation
                        route to CompetitionsParticipation with competitionid
                    deleteCompetition
                        hide deleteConfirmation modal
                            on hidden, route to CompetitionsView
                        doDeleteCompetition(competitionid)
                    teamLeaderboardDrilldown(id, name)
                        $scope.drillteamname = name
                        vm.apipage.teamid = id
                        vm.apipage.teamname = name
                        create a request model
                        send a GET request with the request model to the api (getTeamLeaderboardTallyPage)
                        on success
                            data = response.data
                            obj = data.Items
                            set apipage totals
                                vm.apipage.subpgtotal = Math.ceil(data.TotalCount / vm.apipage.subpgsize);
                                vm.apipage.subtotalcount = data.TotalCount;
                            if return object is truthy
                                vm.teamcontribution = obj
                                // redact certain membername fields
                                foreach item in vm.teamcontribution
                                    if !item.CanBeProfileOnLeaderboard
                                        item.FirstName = "*"
                                        item.LastName = "*"
                                        item.DisplayName = basedata.redactedname
                                hide #teamleaderboard-panel
                                show #teamcontribution-panel
                    hideLeaderboardDrilldown
                        vm.apipage.subpgcurrent = 1
                        show #teamleaderboard-panel
                        hide #teamcontribution-panel
                    groupLeaderboardDrilldown(id, name)
                        $scope.drillgroupname = name
                        vm.apipage.groupid = id
                        vm.apipage.groupname = name
                        create a request model
                        send a GET request with the request model to the api (getGroupLeaderboardTallyPage)
                        on success
                            data = response.data
                            obj = data.Items
                            set apipage totals
                                vm.apipage.subpgtotal = Math.ceil(data.TotalCount / vm.apipage.subpgsize);
                                vm.apipage.subtotalcount = data.TotalCount;
                            if return object is truthy
                                vm.groupcontribution = obj
                                // redact certain membername fields
                                foreach item in vm.groupcontribution
                                    if !item.CanBeProfileOnLeaderboard
                                        item.FirstName = "*"
                                        item.LastName = "*"
                                        item.DisplayName = basedata.redactedname
                                hide #groupleaderboard-panel
                                show #groupcontribution-panel
                    hideGroupLeaderboardDrilldown
                        vm.apipage.subpgcurrent = 1
                        show #groupleaderboard-panel
                        hide #groupcontribution-panel
                    doIndividualInvitation(ref)
                        if ref = accept
                            create a request model where ConfirmationStatusId = confirmed
                            send a POST request with the request model to the api (updateChallenge)
                            reload the page
                        else
                            create a request model where ConfirmationStatusId = declined
                            send a POST request with the request model to the api (updateChallenge)
                            route to CompetitionsView
                    displayCompetitionDetail
                        set scope variables for common display items
                            comptitle, startdate, enddate, enrollstart, enrollend
                            description, displayShortList, displayViewFullActList
                        check for fitness subtype (fitness, nutrition, wellness)
                            if activity types exist in competitiondetail
                                create a comma-separated string of all activity type names (fitnessitems)
                                create an array (subtypes) containing the ActivityTypeId
                                set $scope.fitnesslist = fitnessitems
                                if competitiondetail does not include all activities
                                    sort an activitylist (vm.competitiondetail.Activities) by activity name
                                    if activity list contains more than 5 activities
                                        show first 5 activities with [...] to view full list
                                    else
                                        show all activities; do not show [...] to view full list
                                    set $scope.displayShortList array to viewable activities (allowed)
                                else
                                    getFitnessActivities(subtypes)
                            else
                                set $scope.fitnesslist to empty string
                            if competitiondetail.Biometrics is truthy
                                set $scope.biomeasure to competitiondetail.biometrics[0].BiometricName
                            // set goal amount
                            $scope.totalgoalamt = competitiondetail.TotalGoalAmt
                            // set goal measure description
                            if competitiondetail.GoalMeasureId = count
                                measurename = default entries label ("Count")
                            else if competitiondetail.GoalMeasureId = measure
                                if checkInCategoryId = activity
                                    measurename = competitiondetail.ActivityMeasureName
                                else if checkInCategoryId = biometric
                                    measurename = competitiondetail.BiometricMeasureName
                                else error
                            else if competitiondetail.GoalMeasureId = points
                                measurename = "Points"
                            else error
                            $scope.measurename = measurename
                            $scope.showdetails = true
                            if $scope.isPublicOrPrivateAndEntered()
                                if competitiondetail.Tallied
                                    set compLeaderboardPanelLbl = "Final Leaderboard"
                                if competitiondetail.IsEntered
                                    $scope.goToUserPage = true
                                    getLeaderboardTally()
                                else
                                    getLeaderboardTally()
                            if competitiondetail.IsEntered
                                getMyCompetitionRank()
                            if competitiondetail.AccessLevelId = private
                                loadOwnerInfo()
                    loadOwnerInfo
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getCompetitionOwnerDetails)
                            on success
                                set vm.ownerinfo = response items
                                set $scope.ownerDisplay = vm.ownerinfo[0]
                    getCompetitionMembersEntered
                        //get all members invited to individual private competition
                        if app.profile is truthy
                            create a request model
                            initialize some variables
                                var memberInvite = [];
                                var memberInvited = false;
                                vm.indcompmembers = [];
                            send a GET request with the request model to the api (getCompetitionMembersEntered)
                            on success
                                set obj to returned data items
                                if obj is truthy
                                    for all items in obj
                                        if item.ConfirmationStatusId != declined
                                            push item onto vm.indcompmembers
                                        if item.MemberUid == app.profile.MemberUid
                                            memberInvited = true
                                            memberInvite = item
                                // if member has been invited but not yet entered, show details and invite
                                if memberInvited == true && memberInvite.ConfirmationStatusId == no response
                                    $scope.showIndInvite = true
                                    displayCompetitionDetail()
                                    if !competitiondetail.Tallied
                                        $scope.showIndInvitedList = true
                                // if competition is a private individual competition and user has not been invited or declined, don't show details
                                else
                                    $scope.canViewCompetition = false
                            // if competition is public or user is entered, display details
                            if competitiondetail.AccessLevelId == public or competitiondetail.IsEntered
                                displayCompetitionDetail()
                            // if competition is a private team competition and user has not yet entered, don't display details (must respond to invite on participation invite)
                            if (competitiondetail.AccessLevelId == private
                                && competitiondetail.EnrollmentCategoryId == team
                                && !competitiondetail.IsEntered)
                                $scope.canViewCompetition = false
                    getFitnessActivities(subtypes)
                        create a request model
                        send a GET request with the request model to the api (getFitnessActivities)
                        on success
                            set vm.fitactivities = returned data items
                            foreach items in fitactivities
                                if item.ActivityTypeId is in subtypes
                                    if competitiondetail.ActivityMeasureId is null or ""
                                        push item onto vm.qualifiedactivities
                                    else if competitiondetail.ActivityMeasureId == item.ActivityMeasureID
                                        push item onto vm.qualifiedActivities
                    getMyCompetitionRank
                        if app.profile is truthy
                            create a request model
                            initialize arrays to []
                                vm.rankings, vm.indrankings, vm.teamrankings, vm.grouprankings
                            send a GET request with the request model to the api (getMyCompetitionRank)
                            on success
                                set obj = returned items
                                if object is truthy
                                    vm.rankings = obj
                                    if vm.rankings has one or more items
                                        // what kind of rankings do I have?
                                        if vm.rankings[0].MemberUid has a valid value
                                            vm.indrankings = vm.rankings
                                        else if vm.rankings[0].TeamId >= 1
                                            vm.teamrankings = vm.rankings
                                        else if vm.rankings[0].GroupId >= 1
                                            vm.grouprankings = vm.rankings
                                        else error
                    getLeaderboardTally
                        if app.profile is truthy
                            initialize request model to {} and updatePage = false
                            if $scope.goToUserPage == true
                                set request model with "SkipToMyPage" : true
                                $scope.goToUserPage = false
                                updatePage = true
                            else
                                set request model with "Page" : vm.apipage.pgcurrent
                            initialize arrays to []
                                vm.leaderboard, vm.indleaderboard, vm.teamleaderboard, vm.groupleaderboard
                                send a GET request with the request model to the api (getLeaderBoardTally)
                                on success
                                    set obj to returned data items
                                    // set apipage total
                                    vm.apipage.pgtotal = Math.ceil(data.TotalCount / vm.apipage.pgsize);
                                    vm.apipage.totalcount = data.TotalCount;

                                    //update current page from result (needed if SkipToMyPage was true)
                                    if(updatePage){
                                        vm.apipage.pgcurrent = data.Page;
                                    }
                                    if obj is truthy
                                        set vm.leaderboard = obj
                                        if vm.leaderboard has one more item
                                            if vm.leaderboard[0].MemberUid has a valid value
                                                foreach item in vm.leaderboard
                                                    // redact data
                                                    if !item.CanBeProfileOnLeaderboard
                                                        item.FirstName = *
                                                        item.LastName = *
                                                        item.DisplayName = basedata.redactedname
                                                    item.medal = conf.showAchvRank ? _$help.DetermineMedal(vm.leaderboard[i].AchvRankID) : "";
                                                    item.achvrank = conf.showAchvRank ? _$help.DetermineRank(vm.leaderboard[i].AchvRankID) : "";
                                                    push item onto vm.indleaderboard
                                            else if vm.leaderboard[0].TeamId >= 1
                                                vm.teamleaderboard = vm.leaderboard
                                            else if vm.leaderboard[0].GroupId >= 1
                                                vm.groupleaderboard = vm.leaderboard
                                            else error
                other methods
                    doDeleteCompetition(id)
                        if app.profile is truthy
                            create a request model
                            send a DELETE request with the request model to the api (deleteCompetition)
                    getCompetitionDetail
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getCompetitionDetail)
                            on success
                                set obj to first item in response items
                                if obj is truthy
                                    set vm.competitiondetail = obj
                                    if competition.AccessLevelId == public or competition.IsEntered
                                        displayCompetitionDetail()
                                    else if competition.EnrollmentCategoryId == individual
                                        && competition.AccessLevelId == private
                                        && !competition.IsEntered
                                            getCompetitionMemberEntered()
                                    else
                                        $scope.canViewCompetition = false
                                else
                                    returnToView()
                    activate
                        make async calls to get array of promises
                            getCompetitionDetail()
                        activate the controller via the common module with promises and controllerId
                activate()
        detail.html
            Back button
            if user not allowed to view competition
                show div with explanation
            if user allowed to view competition
                Competition Details panel
                    Competition
                        Competition title
                        Start date - End date
                        if public competition
                            Enrollment start date - Enrollment end date
                        if ownerDisplay is not empty
                            First name, last name, display name, 
                        if enrollment category = team
                            Entry name
                    Description
                        show icons/text for access level, enrollment category
                        if not all activities allowed, display short list
                        if displayViewFullActList, link to modal (#qualifiedActivities, showing competitionDetail.Activities)
                        if all activities allowed, link to modal (#qualifiedActivities, showing vm.qualifiedActivities)
                        if competition includes biometrics, show biometric measure
                    Goal (if showLeaderboardAmounts)
                        {TotalGoalAmount}  {MeasureName}
                    Button (if isCompPubCanEnroll)
                        Enter competition
                    Button Group (if isCompPriOwner & (competition status is pending || isStartingOnOrAfterToday))
                        Edit Competition
                        Send Individual Invitations (if enrollment category = individual)
                        Send Team Invitations (if enrollment category = team)
                        Delete Competition
                    Button Group (if isCompTeamEntered)
                        Delete Confirmation (if isCompPriOwner && !(competition status is pending || isStartingOnOrAfterToday))
                        Manage Participation
            Invitation panel (if showIndInvite)
                "Do you want to accept invitation?" (if !isTallied)
                "Final tally is complete. Please decline to remove" (if isTallied)
                Accept Invitation button
                Decline Invitation button
            Invited Individuals panel (if showIndInvitedList)
                Achievement rank
                Name (first, last, displayname)
                Response (status)
            My Rank panel
                (if any individual rankings)
                    Rank {LeaderboardTallyOrdinal in vm.indrankins}
                    {TallyAmount} {MeasureName} (if showLeaderboardAmounts)
                (if any team rankings)
                    {TeamName} Rank {LeaderboardTallyOrdinal in vm.teamrankings}
                    {TallyAmount} {MeasureName} (Average) (if showLeaderboardAmounts)
                (if any group rankings)
                    {GroupName} Rank {LeaderboardTallyOrdinal in vm.grouprankings}
                    {TallyAmount} {MeasureName} (Average) (if showLeaderboardAmounts)
            Final Leaderboard panel (Individual)
                show if indleaderboard has entries and isPublicOrPrivateAndEntered
                Rank {LeaderboardTallyOrdinal}
                Achievement Rank and Medal (if showAchvRank)
                Entry Name
                Send message link
                Entries {tallyamount} (if showLeaderboardAmounts)
                Footer: pagination (show if pgtotal > 1)
            Final Leaderboard panel (Team)
                show if teamleaderboard has entries and isPublicOrPrivateAndEntered
                Rank {LeaderboardTallyOrdinal}
                {TeamName} (if isInterTenant)
                {TeamName} as link (if !isInterTenant)
                {tallyamount} (if showLeaderboardAmounts)
            Team Contribution panel (currently set as style=display:none)
                Header: Team Contribution: {drillteamname}
                Rank
                Entry name
                Send message link (if communicate setting is true)
                {tallyamount} (if showLeaderboardAmounts)
                Footer: pagination (show if pgtotal > 1)
            Final Leaderboard panel (Group)
                show if groupleaderboard has entries and isPublicOrPrivateAndEntered
                Rank {LeaderboardTallyOrdinal}
                {GroupName} (if isInterTenant)
                {GroupName} as link (if !isInterTenant)
                {tallyamount} (if showLeaderboardAmounts)
                Footer: pagination (show if pgtotal > 1)
            Group Contribution panel (currently set as style=display:none)
                Header: Group Contribution: {drillgroupname}
                Rank
                Entry name
                Send message link (if communicate setting is true)
                {tallyamount} (if showLeaderboardAmounts)
                Footer: pagination (show if pgtotal > 1)
            {syncLeaderboardMsg} (show if any leaderboard (ind, team, group) has 1+ entry)
            Delete confirmation modal
                Cancel button
                Delete button
            Entry confirmation modal
                "Congrats, you entered the competition"
                Continue button
    
    EDIT
        controllers.competitions.edit.js
        edit.html
    
    GRID
        controllers.competitions.grid.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    pageClass(pagenum)
                        if pagenum == $scope.selectedPage
                            return 'active'
                        else return ''
                    displayAccessLevel(key, accesslevelid)
                        returns true if key and competition.AccessLevelId are of the same type (e.g., 'pri', accessLevel.Private)
                click handlers
                    changeSelectPage(pagenum)
                        set $scope.selected page to pagenum
                    goToDetail(id)
                        route to CompetitionsDetail with competitionid
                    updateGrid(view)
                        switch on view
                            'mine':
                                vm.competitions = mycompetitions;
                                $scope.isMine = true;
                                $scope.isAvail = false;
                                $scope.isAll = false;	
                                $scope.compcontext = "mine";
                            'avail':
                                vm.competitions = availcompetitions;
                                $scope.isMine = false;
                                $scope.isAvail = true;
                                $scope.isAll = false;
                                $scope.compcontext = "open";
                            'all':
                                vm.competitions = allcompetitions;
                                $scope.isMine = false;
                                $scope.isAvail = false;
                                $scope.isAll = true;
                                $scope.compcontext = "all";
                        resetFilter()
                    resetFilter(event, form)
                        set $scope variables that serve as models for the filter back to defaults
                            $scope.accesslevel = 'all';
                            $scope.enrollcat = 'all';
                            $scope.compstatus = 'all';
                            $scope.event.accesslevel = $scope.accesslevel;
                            $scope.event.enrollcat = $scope.enrollcat;
                            $scope.event.compstatus = $scope.compstatus;
                            $scope.applyFilter();
                    updateFilter(event, form)
                        apply the user selected items to the filter
                            var pagesize = event.itemsperpage || 20
                            $scope.accesslevel = event.accesslevel;
                            $scope.enrollcat = event.enrollcat;
                            $scope.compstatus = event.compstatus;
                            $scope.pagination = Pagination.getNew(pagesize);
                            $scope.applyFilter();
                    apply filter
                        add items to the filtered competition list
                            foreach item in vm.competitions
                                if item matches the chosen selection in a filter dropdown
                                    add item to the templist array
                            assign templist to vm.filteredgrid
                            set pagination numPages
                other methods
                    getMyCompetitions
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getMyCompetitions)
                            on success
                            assign obj to the returned items
                            if obj is truthy
                                push all items into allcompetitions array
                                if item.IsEntered
                                    push item onto mycompetitions array
                                if item.AccessLevelId == public && item.EnrollmentCategoryId != group && !item.IsEntered && item.CanEnroll
                                    push item onto availcompetitions array
                                switch on $scope.compcontext
                                    'mine':
                                        set competitions = mycompetitions
                                        $scope.isMine = true
                                    'open':
                                        set competitions = availcompetitions
                                        $scope.isAvail = true
                                    default:
                                        set competitions = allcompetitions
                                        $scope.isAll = true
                                applyFilter()
                    activate
                        make async calls to get array of promises
                            getMyCompetitions()
                        activate the controller via the common module with promises and controllerId
                        set defaults according to routeParams
                            $scope.event.accesslevel = $routeParams.accesslevel;
                            $scope.event.enrollcat = $routeParams.enrollcat;
                            $scope.event.compstatus = $routeParams.status;
                            $scope.event.itemsperpage = $routeParams.itemsperpage;
                activate()
        grid.html
            Back button
            Competition Grid buttons (function as filters)
                My Competitions
                Available Competitions
                All Competitions
            Filter Competition List panel
                Access level dropdown (All, Public, Private)
                Enrollment category dropdown (All, Individual, Team, Group)
                Competition status dropdown (All, Pending, InProgress, Completed)
                Items per page (20, 50, 100, 250)
                Update button (apply the selected filters)
            Competitions panel (with # of filtered competitions)
                "no items" div (if no items)
                Icon for type of competition (public, private)
                Start date
                End date
                Competition title (as link)
                Type (enrollment category)
                Status
                Footer: pagination panel if pagination.numPages > 1
                    Prev page "<" (if enabled, clickable)
                    Prev page "<" (if disabled, not clickable)
                    Active page numbers
                    Next page ">" (if enabled, clickable)
                    Next page ">" (if disabled, not clickable)
    
    PARTICIPATION
        controllers.competitions.participation.js
        participation.html

    PARTICIPATIONINVITE
        controllers.competitions.participationinvite.js
        participationinvite.html    

    PRIVATEFITNESS (Competitions tab, Create button)
        controllers.competitions.privatefitness.js
        privatefitness.html

    VIEW (Competitions tab, View button)
        controllers.competitions.view.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    displayEnrollCategory(key, competition.EnrollmentId)
                        returns true if key and competition.EnrollmentId are of the same type (e.g., 'ind', enrollmentType.Individual)
                    displayAccessLevel(key, competition.AccessLevelId)
                        returns true if key and competition.AccessLevelId are of the same type (e.g., 'pri', accessLevel.Private)
                    displayFitnessType(key, obj)
                        create a list of all activityTypeIds for the competition (activityTypeList)
                        returns true if the key's corresponding ActivityTypeId (fitness, nutrition, wellness) exists in the activityTypeList
                    displayBiometricType
                        create a list of a biometricTypeIds for the competition (biometricTypeList)
                        returns true if the key's corresponding BiometricTypeId exists in the biometricTypeList
                event handlers
                    goToDetail(id)
                        route to CompetitionsDetail with id (competitionid)
                    goToInvite(id)
                        find the competition with the id in vm.competitioninvitations
                            if the enrollment category is individual
                                route to CompetitionsDetail with id
                            if the enrollment category is team
                                route to CompetitionsParticipationInvite with id
                            else if the enrollment category is group
                                do nothing (group competitions don't get invitations)
                    goToBadges
                        route to SettingsBadges
                    gotoCompetitions(ref)
                        route to CompetitionsGrid with route params
                            enrollment category = all
                            status = all
                            itemsperpage = 20
                            switch on ref
                                'mycomps'
                                    access level = all
                                    compcontext = mine
                                'newcomps'
                                    access level = pub
                                    compcontext = open
                                default
                                    access level = all
                                    compcontext = all
                other methods
                    getMyCompetitions
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getMyCompetitions)
                            on success, set vm.mycompetitions to the returned items
                    getCompetitionInvitations
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getCompetitionInvites)
                            on success, if returned items are truthy
                                set vm.competitioninvitations to returned items
                    activate
                        make async calls to get array of promises
                            getMyCompetitions()
                            getCompetitionInvitations()
                        activate the controller via the common module with promises and controllerId
                activate()
        view.html
            My Competitions panel
                Title (My Competitions) (clickable - goes to competitions/grid/all/mine)
                "No items" panel (show if no items)
                Shown as table with pagination
                On click, go to competition detail view
                Competition title
                Start date - End date
                Summary of icons
            Invitations panel (show if invitations > 0)
                Shown as table
                On click, go to invitation page
                Team name
                Captain (first, last, displayname)
                Member count
                Footer: View All My Competitions link
            View Badges button
            Private Competitions panel
                "No Items" div (if applicable)
                Competition title
                Start date - End date
                Name (first, last, displayname)
                Challenger info
                    first, last, displayname  (based on CompetitionInfo.TeamID < 1)
                    OR first, last, displayname - entryname  (based on CompetitionInfo.TeamID >= 1)
                Invited Team info
                    Team name
            Available New Competitions (public) panel
                Panel title (clickable, go to competitions)
                Panel body (show if any new public team competitions available)
                    order by StartDate, limit to 4
                    Competitions show as table
                        StartDate - EndDate
                        Show a corresponding icon based on enrollment category, access level, fitness type, or biometric type
                Panel footer
                    View All Available New Competitions (clickable)
            View All Competitions button

DASHBOARD
    controllers.dashboard.js

ENTRIES
    controllers.entries.js
        contains data for user options under the Entries tab  (create (default), view activity, view biometric, about)
        contains data for default entry type (fitness) in decorateEntriesUrl
    
    ABOUT (Entries tab, About button)
        controllers.entries.about.js
            see PropelHTML5\App\core\locale\en-US\about.js
            see PropelHTML5\App\core\locale\en-US\basedata.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any defaults needed for the view
                other methods
                    activate
                        activate the controller via the common module with controllerId
                activate()
        about.html
            static page that binds to a variable containing HTML markup and gives helpful information

    DETAILBIOMETRIC (Entries tab, View Biometric button, (in grid view) click the Biometric name)
        controllers.entries.detailbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    isDelegate
                        determines if user is a delegate (coach) based on the user's UID (in the route params)
                event handlers
                    clickEdit
                        updates the window location url to the EDITBIOMETRIC route
                    clickDelete
                        hides the Delete modal
                        doDeleteEntry()
                    doDeleteEntry
                        checks for truthiness of app.profile
                        get memberId from app.profile or delegateUid
                        construct the request model
                        make a DELETE call
                other methods
                    getEntryDetailBiometric
                        checks for truthiness of app.profile and routeParams
                        get memberId from app.profile or delegateUid
                        construct the request model
                        make a GET call to getEntryDetailBbiometric url
                        on successful response, assign display values from the data object
                        set values to show calories, points, etc.
                    activate
                        make async calls to get array of promises
                            getEntryDetailBiometric()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailbiometric.html
            Biometric Entry panel
                Date
                Notes
                Measurement
                    Description
                    Amount - Measure
                    DataProviderInfo
            Edit button
            Delete button
            Text-Info ('entriesCanModifyNoAccessMsg')
            Back button
            Modal for delete confirmation

    DETAILFITNESS (Entries tab, View Activity button, click the Activity name ('5k Run'))
        controllers.entries.detailfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    isDelegate
                        determines if user is a delegate (coach) based on the user's UID (in the route params)
                event handlers
                    clickEdit
                        updates the window location url to the EDITFITNESS route
                    clickDelete
                        hides the Delete modal
                        doDeleteEntry()
                    getEntryDetailFitness
                        checks for truthiness of app.profile and routeParams
                        get memberId from app.profile or delegateUid
                        construct the request model
                        make a GET call to getEntryDetailFitness url
                        on successful response, assign display values from the data object
                        set values to show calories, points, etc.
                    doDeleteEntry
                        checks for truthiness of app.profile
                        get memberId from app.profile or delegateUid
                        construct the request model
                        make a DELETE call
                other methods
                    activate
                        make async calls to get array of promises
                            getEntryDetailFitness()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailfitness.html
            Activity Entry panel
                Date
                Notes
                Activity
                    Description
                    Amount - Measure
                    DataProviderInfo
                Points
                    Calculated Points
                    Calculated Calories (if applicable)
            Edit button
            Delete button
            Text-Info ('entriesCanModifyNoAccessMsg')
            Back button
            Modal for delete confirmation

    EDITBIOMETRIC (Entries tab, View Biometric button, DetailBiometric view, Edit button)
        controllers.entries.editbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                formats dates with Moment.js (deprecated; recommended to use Day.js or Luxon)
                computed values
                    entryDateRange
                        validates the date entered against the allowable daterange
                        inputdate is between mindate/maxdate (inclusive)
                    isDelegateSelected
                        are we keeping this?
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    onActivitySelect
                        if a biometric is selected
                            set some additional form values based on the selected activity
                            evaluateMeasureParams()
                    evaluateMeasureParams
                        valid = true if no range defined
                        validate the amount against the allowed range of values
                        validate the number of digits after the decimal in the amount
                    doSubmit
                        if form is valid,
                            create the request model from the form values
                            submit model to the api
                            on success, return to the calling url
                other methods
                    getHealthCategories
                        if app.profile is truthy
                            create a request model
                            make a GET request to the api
                            if an object gets returned
                                create two lists of biometrics (public, private)
                                assign vm.allhealthcategories to return object
                                modify the biometric names to say 'disabled' if CanUserCreateReference == false
                                    and Enabled == false
                                separate the biometrics into public and private
                                ** not sure what else is happening here
                                    build the privatecategory list
                    setLocalAppSettings
                        the app settings should either be only loaded once at the initial load of the tracker (possibly injected in the HTML - the current tracker does this) OR should be cached.
                        sets the min/max for entry datepicker
                        new endpoint for getting app settings when not authenticated: /configuration/default
                        new endpoint for getting app settings when authenticated: /configuration/user
                    getDelegateMembers
                        not keeping?
                    getEditDetail
                        if app.profile and activityid are truthy
                            create the request model
                            make a GET request to the api with the request model
                            on success, setEditDetail()
                            else return to calling url
                    getPrivateHealthCategories
                        if app.profile is truthy
                            create a request model
                            send the model with a GET request to api
                            save result as array of privateHealthCategories
                            getHealthCategories()
                    activate
                        make async calls to get array of promises
                            setLocalAppSettings()
                            getDelegateMembers()
                            getEditDetail()
                            getPrivateHealthCategories()
                        activate the controller via the common module withpromises and controllerId
                activate()
        editbiometric.html
            link to show help text in entry form
            selector buttons for four types of entries (fitness activity, nutrition activity, wellness, activity, biometric entry)
            the content for "which biometric" changes based on the biometric type
            biometric measure label for units changes based on the selected biometric type
            validates form data for required input, format, range, etc.
                date: required, format dd/mm/yyyy, range is 60 days prior to entry date
                activity: required
                amount: see validation rules (range, values, etc)
                notes: optional
            submit button disabled until form validation passes

    EDITFITNESS (Entries tab, View Activity button, DetailFitness view, Edit button)
        controllers.entries.editfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                set any default values needed for the view
                formats dates with Moment.js library (deprecated; recommended to use Day.js or Luxon)
                computed values
                    entryDateRange
                        validates the date entered against the allowable daterange
                        inputdate is between mindate/maxdate (inclusive)
                    isValidActivity
                        validates activity as required field
                    isDelegateSelected
                        are we keeping this??
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    onActivitySelect
                        if an activity is selected
                            show the Share as Favorite button
                            set some additional form values based on the selected activity
                            evaluateMeasureParams()
                            $rootScope.prepSharedFavorites() ??
                        else
                            hide Share as Favorite button
                            reset activity measure name label to default
                    evaluateMeasureParams
                        validate the amount as true if no range defined
                        validate the amount against the allowed range of values
                        validate the number of digits (2) after the decimal in the amount
                        update the calculator values for points, calories burned, calories consumed
                    doSubmit
                        create the request model from the form values
                        POST the request model to the api
                        on success, return back to the calling URL
                other methods
                    setEditDetail
                        set default values for the selected activity
                        validate activity as required
                        call 'whichActivitySelected' (which simply calls evaluateMeasureParams)
                        set startDate and validate as required
                        set amount and validate as required
                        call 'onActivitySelect'
                        set notes
                        if delegate is being used, disable notes
                        getMostRecentWeight()
                    setLocalAppSettings
                        the app settings should either be only loaded once at the initial load of the tracker (possibly injected in the HTML - the current tracker does this) OR should be cached.
                        sets the min/max for entry datepicker
                        new endpoint for getting app settings when not authenticated: /configuration/default
                        new endpoint for getting app settings when authenticated: /configuration/user
                    getMostRecentWeight
                        gets most recent weight entry for the member
                            create the request model
                            make a GET call to the api
                            if an item is returned and measure system is metric, convert lbs to kg
                    getDelegateMembers
                        not doing this?
                    getEditDetail
                        if app.profile and activityid are truthy
                            create the request model
                            make a GET request to the api with the request model
                            on success, setEditDetail()
                            else return to calling url
                    getPrivateActivities
                        ** OLD ** successively gets private, favorite, and fitness activities
                            get private activities at /activity/private and push Ids into array
                            get favorite activities at /activity/favorite and push Ids into array
                            get activity list at /activity/localized
                        ** NEW **
                            load one complete list of activities into the app and leverage caching
                                public + private + favorites?
                            render a filtered list of activities based on the view and use case
                                filter by activityTypeId, access level (public/private)
                                when creating an activity, filter by CanUserCreateReference and Enabled
                                when editing an activity, follow same rule as for 'create' but also keep the current activity selected, even if it disabled
                    activate
                        makes async calls to get promises
                            setLocalAppSettings()
                            getMostRecentWeight()
                            getEditDetail()
                            getPrivateActivities()
                            getDelegateMembers()
                        activate the controller with the promises and controllerId
                activate()
        editfitness.html
            link to show back button
            link to show help text in entry form
            select-list for delegates, if any
            the content for "which activity" changes based on the activity type
            activity measure label for units changes based on the selected activity type
            user can share activity as a favorite after one is selected
            validates form data for required input, format, range, etc.
                date: required, format dd/mm/yyyy, range is 60 days prior to entry date
                activity: required
                amount/activity measure: see validation rules (range, values, etc)
                notes: optional
            show points and calories (if applicable) when entering amount values
            cancel button
            save button disabled until form validation passes

    GRIDBIOMETRIC (Entries tab, View Biometric button, (in Latest Biometrics) grid button or View All Biometric Entries)
        controllers.entries.gridbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    pageClass - updates class for active page
                    isDelegateSelected - are we keeping this?
                    isActivitySelected
                event handlers
                    changeSelectPage - handles pagination
                    gotoUrl
                        click handler for viewing details; handles delegates in the url
                    updateFilter
                    prepDeleteEntry
                        prepare items (message) for deleting an entry; show the delete modal
                    deleteEntry
                        if app.profile is truthy
                            create the request model
                            send a DELETE request with the request model to the api
                            if success
                                reset some values
                                getBiometricEntries()
                other methods
                    getDelegateMembers - are we keeping this?
                    getHealthCategories
                        if app.profile is truthy
                            create the request model
                            send a GET request with the request model to the api
                            assign response object to model used for activities dropdown list
                    getBiometricEntries
                        if app.profile is truthy
                            create the request model
                            send a GET request with the request model to the api
                            if an activity is selected (activityid >= 1)
                                get all the entries with the selected BiometricId
                                push those entries into an array for the grid display
                                if there are any entries to display in the chart
                                    set the chart object and graph title
                                else
                                    hide the chart panel and clear the chart data
                                singleBiometricEntriesGraph(vm.chart, "#bioentriesgraph1")
                                    activate the chart
                                    see PropelHTML5\App\common\tvc\tvc-propel-highchart.js
                                set the canModify value for each entry
                                    see PropelHTML5\App\core\helpers\permissions.js
                                set any pagination values needed for correct viewing
                    activate
                        make async calls to get array of promises
                            getDelegateMembers()
                            getHealthCategories()
                            getBiometricEntries()
                        activate the controller via the common module with promises and controllerId
                activate()
        gridbiometric.html
            Back button
            Filter row
                if delegates, show delegate dropdown list
                biometrics dropdown
                items per page dropdown
                update filter button
            Chart panel (highcharts)
            List of recent biometrics entries for selected biometric
                Date, Biometric Measure (ex. Weight), Amount, Delete?, icon for locked if cannot modify
            Pagination controls
            Delete dialog modal

    GRIDFITNESS (Entries tab, View Activity button, (in Recent Activity)grid button or View All Activity Entries)
        controllers.entries.gridfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    pageClass - updates class for active page
                    isDelegateSelected - are we keeping this?
                    isSubtypeSelected - syncs the selected subtype (all, fitness, nutrition, wellness) from the url
                    isActivitySelected - syncs the selected activity type from the url
                event handlers
                    changeSelectPage - handles pagination
                    gotoUrl
                        click handler for viewing details; handles delegates in the url
                    updateSubtype
                        click handler; refreshes fitness activities to sync
                    updateFilter
                        click handler for filter; refreshes fitness entries
                    prepDeleteEntry
                        prepare items (message) for deleting an entry; show the delete modal
                    deleteEntry
                        if app.profile is truthy
                            create the request model
                            send a DELETE request with the request model to the api
                            if success
                                reset some values
                                getFitnessEntries()
                other methods
                    getDelegateMembers - are we keeping this?
                    getFitnessActivities
                        if app.profile is truthy
                            create the request model
                            send a GET request with the request model to the api
                            get activities that match activity type for use with activities dropdown list
                    getFitnessEntries
                        if app.profile is truthy
                            create the request model
                            send a GET request with the request model to the api
                            if a specific subtype is selected
                                get all the activities with the selected ActivityTypeId
                            if an activity is selected (activityid >= 1)
                                get all the entries with the selected ActivityId
                                push those entries into an array for the grid display
                                if there are any entries to display in the chart
                                    set the chart object and graph title
                                else
                                    hide the chart panel and clear the chart data
                                singleActivityEntriesGraph(vm.chart, "#actentriesgraph1")
                                    activate the chart
                                    see PropelHTML5\App\common\tvc\tvc-propel-highchart.js
                                add the respective icon for the activity subtype
                                set the canModify value for each entry
                                    see PropelHTML5\App\core\helpers\permissions.js
                                calculate the activity points and calories
                                set any pagination values needed for correct viewing
                    activate
                        make async calls to get array of promises
                            getDelegateMembers()
                            getFitnessActivities()
                            getFitnessEntries()
                        activate the controller via the common module withpromises and controllerId
                activate()
        gridfitness.html
            Back button
            Filter row
                if delegates, show delegate dropdown list
                fitnesssubtype dropdown
                activities dropdown
                items per page dropdown
                update filter button
            Chart panel (highcharts)
            List of recent biometrics entries for selected biometric
                Activity icon, Date, Activity, Amount, Points, Calories burned Delete?, icon for locked if cannot modify
            Pagination controls
            Delete dialog modal

    NEWBIOMETRIC (Entries tab, Create button, Biometric sub-button)
        controllers.entries.newbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                formats dates with Moment.js (deprecated; recommended to use Day.js or Luxon)
                computed values
                    entryDateRange
                        validates the date entered against the allowable daterange
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    goToForm
                        route to the selected entry form component
                    onActivitySelect
                        set some additional form values based on the selected activity
                        evaluateMeasureParams()
                    evaluateMeasureParams
                        valid = true if no range defined
                        validate the amount against the allowed range of values
                        validate the number of digits after the decimal in the amount
                    doSubmit
                        create the request model from the form values
                        submit model to the api
                        on success
                            reset form values
                            show alert for sucess or failure
                    resetForm
                        needed only in a 'delegate' situation?
                other methods
                    getHealthCategories
                        if app.profile is truthy
                            create a request model
                            make a GET request to the api
                            if an object gets returned
                                create two lists of biometrics (public, private)
                                assign vm.healthcategories to public list
                                ** not sure what else is happening here
                    setLocalAppSettings
                        the app settings should either be only loaded once at the initial load of the tracker (possibly injected in the HTML - the current tracker does this) OR should be cached.
                        sets the min/max for entry datepicker
                        new endpoint for getting app settings when not authenticated: /configuration/default
                        new endpoint for getting app settings when authenticated: /configuration/user
                    getDelegateMembers
                        are we still doing this?
                    getPrivateHealthCategories
                        if app.profile is truthy
                            create a request model
                            send the model with a GET request to api
                            save result as array of privateHealthCategories
                            getHealthCategories()
                    activate
                        make async calls to get array of promises
                            setLocalAppSettings()
                            getDelegateMembers()
                            getPrivateHealthCategories()
                        activate the controller via the common module with promises and controllerId
                activate()
        newbiometric.html
            link to show help text in entry form
            selector buttons for four types of entries (fitness activity, nutrition activity, wellness, activity, biometric entry)
            the content for "which biometric" changes based on the biometric type
            biometric measure label for units changes based on the selected biometric type
            validates form data for required input, format, range, etc.
                date: required, format dd/mm/yyyy, range is 60 days prior to entry date
                activity: required
                amount: see validation rules (range, values, etc)
                notes: optional
            submit button disabled until form validation passes

    NEWFITNESS (Entries tab, Create button, Fitness/Nutrition/Wellness sub-button)
        controllers.entries.newfitness.js (Fitness [id:1], Nutrition [id:2], Wellness[id:3])
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                formats dates with Moment.js library (deprecated; recommended to use Day.js or Luxon)
                computed values
                    entryDateRange
                        validates the date entered against the allowable daterange
                    isValidActivity
                        validates activity as required field
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    goToForm
                        route to the selected entry form component
                    onActivitySelect
                        show the Share as Favorite button
                        set some additional form values based on the selected activity
                        evaluateMeasureParams()
                    evaluateMeasureParams
                        validate the amount as true if no range defined
                        validate the amount against the allowed range of values
                        validate the number of digits after the decimal in the amount
                        update the calculator values for points, calories burned, calories consumed
                    doSubmit
                        create the request model from the form values
                        submit model to the api
                        on success
                            reset form values
                            show alert for sucess or failure
                    resetForm
                        needed only in a 'delegate' situation?
                other methods
                    setLocalAppSettings
                        the app settings should either be only loaded once at the initial load of the tracker (possibly injected in the HTML - the current tracker does this) OR should be cached.
                        sets the min/max for entry datepicker
                        new endpoint for getting app settings when not authenticated: /configuration/default
                        new endpoint for getting app settings when authenticated: /configuration/user
                    getMostRecentWeight
                        gets most recent weight entry for the member; if measure system is metric, convert lbs to kg
                    getDelegateMembers
                        not doing this?
                    getPrivateActivities
                        ** OLD ** successively gets private, favorite, and fitness activities
                            get private activities at /activity/private and push Ids into array
                            get favorite activities at /activity/favorite and push Ids into array
                            get activity list at /activity/localized
                        ** NEW **
                            load one complete list of activities into the app and leverage caching
                                public + private + favorites?
                            render a filtered list of activities based on the view and use case
                                filter by activityTypeId, access level (public/private)
                                when creating an activity, filter by CanUserCreateReference and Enabled
                                when editing an activity, follow same rule as for 'create' but also keep the current activity selected, even if it disabled
                    activate
                        makes async calls to get promises
                            setLocalAppSettings()
                            getMostRecentWeight()
                            getDelegateMembers()
                            getPrivateActivities()
                        activate the controller via the common module with the promises and controllerId
                        highlight the selected activity type button
                activate()
        newfitness.html
            link to show help text in entry form
            selector buttons for four types of entries (fitness activity, nutrition activity, wellness, activity, biometric entry)
            the structure of the entry form for each of the activity types (fitness, nutrition, wellness) is the same
            the content for "which activity" changes based on the activity type
            activity measure label for units changes based on the selected activity type
            user can share activity as a favorite after one is selected
            validates form data for required input, format, range, etc.
                date: required, format dd/mm/yyyy, range is 60 days prior to entry date
                activity: required
                amount: see validation rules (range, values, etc)
                notes: optional
            show points and calories (if applicable) when entering amount values
            submit button disabled until form validation passes

    STATS (This controller and view are not used)
        controllers.entries.stats.js
        stats.html
    
    VIEWBIOMETRIC (Entries tab, View Biometric button)
        controllers.entries.viewbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                event handlers
                    gotoUrl
                        click handler for viewing details; handles delegates in the url
                        navigates to DetailBiometric or NewBiometric
                    drillDown
                        click handler that navigates to GridBiometric
                    deleteRecord
                        calls deleteEntry
                    viewAll
                        navigates to GridBiometric with activityId set to -1
                    populateMostRecentEntries
                        if app.profile is truthy and entries list contains at least 1 entry
                            create a new request model
                            send a GET request with the model to the api (getMostRecentByHealthCategory)
                            foreach most recent entry by health category
                                foreach entry
                                    if the entry (category) biometridId matches the most recent entry BiometricId
                                        populate these values for entries
                                            BiometricCheckInId
                                            BiometricCheckInAmount
                                            BiometricCheckInDate
                                            DataProviderInfo (from _$help.DataProviderNameSourceFormatter)
                    deleteEntry
                        if app.profile is truthy
                            create a request model
                            send a DELETE request with the model to the api
                            call getBiometricEntries
                other methods
                    getBiometricMostRecentEntries (get most recent entry for 10 different biometrics)
                        if app.profile is truthy
                            create a request model
                            send a GET request with the model to the api (getHealthCategories)
                            if data is returned
                                for each item in data returned
                                    create a default data object for the item
                                    push item into entries array with sort order value
                                        sort order
                                            weight
                                            height
                                            bmi
                                            blood glucose
                                            blood pressure (systolic)
                                            blood pressure (diastolic)
                                            cholesterol LDL
                                            cholesterol HDL
                                            cholesterol total
                                            cholesterol triglycerides 
                    getChartInfo
                        if app.profile is truthy
                            set relevant date values
                                current date = today
                                cutoff date = 1 year prior to today
                            create a request model
                            send a GET request with the model to the api (getBiometricEntries)
                            if data is sent back
                                create data objects for the chart (progseries)
                            if data exists in progseries
                                create a chart initialization object
                                call singleBiometricEntriesGraph to activate the graph
                    activate
                        make async calls to get array of promises
                            getBiometricMostRecentEntries()
                            getChartInfo()
                        activate the controller via the common module with promises and controllerId
                activate()
        viewbiometric.html
            Chart panel
                highlights Weight or possibly the latest checkin?
            Biometrics panel (latest entries)
                shows 10 of the most popular biometrics
    
    VIEWFITNESS (Entries tab, View Activity button)
        controllers.entries.viewfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                clear rootscope cache
                get the log function from common.logger
                set any default values needed for the view
                event handlers
                    gotoUrl
                        click handler for viewing details; handles delegates in the url
                        navigates to DetailFitness
                    drillDown
                        click handler that navigates to GridFitness
                    deleteRecord
                        calls deleteEntry
                    getIcon
                        gets the appropriate icon for the activity subtype
                    viewAll
                        navigates to GridFitness with activityId set to -1
                    deleteEntry
                        if app.profile is truthy
                            create a request model
                            send a DELETE request with the model to the api (deleteFitnessEntry)
                            call getFitnessEntries
                other methods
                    getFitnessEntries
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getFitnessEntries)
                            on success
                                assign response items to vm.entries
                                append icon data to each entry object
                                    fitness: ./Images/icons/icon_64_fitness.png
                                    nutrition: ./Images/icons/icon_64_nutrition.png
                                    wellness: ./Images/icons/icon_64_wellness.png
                                append dataProviderInfo (using helper method DataProviderNameSourceFormatter)
                    getChartInfo
                        if app.profile is truthy
                            set relevant date values
                                current date = today
                                cutoff date = 1 year prior to today
                            create a request model
                            send a GET request with the model to the api (getFitnessEntries)
                            if data is sent back
                                create data objects for the chart in one of three series
                                    fitnessseries
                                    nutritionseries
                                    wellnessseries
                            if data exists in any of the 3 series
                                create a chart initialization object
                                call activityEntriesByTypeGraph to activate the graph
                        else
                            hide the chart panel
                    activate
                        make async calls to get array of promises
                            getFitnessEntries()
                            getChartInfo()
                        activate the controller via the common module with promises and controllerId
                activate()
        viewfitness.html
            Chart panel
                highlights latest checkins for Fitness, Nutrition, and Wellness activities
            Recent Activity panel
                shows specific activity checkins, allowing you to view details or drill down to additional data

GOALS
    controllers.goals.js
        contains json data for the three subitems under goals tab (View, Create, About)

    ABOUT (Goals tab, About button)
        controllers.goals.about.js
            see PropelHTML5\App\core\locale\en-US\about.js
            see PropelHTML5\App\core\locale\en-US\basedata.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any defaults needed for the view
                other methods
                    activate
                        activate the controller via the common module with controllerId
                activate()            
        about.html

    DETAILBIOMETRIC (Goals tab, View button, select a biometric goal)
        controllers.goals.detailbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                event handlers
                    gotoEdit
                        navigates to GoalsEditBiometric
                    deleteGoal
                        hides the delete goal dialog modal
                        calls doDeleteGoal
                other methods
                    doDeleteGoal
                        if app.profile is truthy
                            create the request model
                            send a DELETE request with the model to the api (DeleteBiometricGoal)
                    getChartInfo
                        if app.profile is truthy
                            create a request model
                            send a GET request with the model to the api (getHealthGoalEntries)
                            if returned items exist (are truthy)
                                create items for the progress series; push to an array
                                if biometric measure name == null, set label to default
                                else set to goalInfo.BiometricMeasureName
                                if goalInfo.DateIntervalId == "day"
                                    set local variable dateinterval to "day", else "weeks"
                                create a chart initialization object
                                initialize the chart with the object (biometricGoalDetail)
                            else hide the chart panel
                    getBiometricGoals
                        if app.profile is truthy
                            create a request model
                            make a GET call with request model to api (getBiometricGoalDetail)
                            set scope/view values for items displayed in the detail panel from the returned object
                            if DateIntervalId == "day", then set label to "days"
                            if DateIntervalId == "week, then set label to "weeks"
                            getChartInfo()
                    activate
                        make async calls to get array of promises
                            getBiometricGoals()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailbiometric.html
            Chart panel with goal and progress
            Goal panel with details
                Goal details
                    Start goal info
                    End goal info
                    Biometric measure to track - name, amount data provider
                    Notes
                Edit button
                Delete button

    DETAILFITNESS (Goals tab, View button, select an activity goal)
        controllers.goals.detailfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                event handlers
                    gotoEdit
                        navigates to GoalsEditFitness
                    deleteGoal
                        hides the delete goal dialog modal
                        calls doDeleteGoal
                other methods
                    doDeleteGoal
                        if app.profile is truthy
                            create the request model
                            send a DELETE request with the model to the api (DeleteFitnessGoal)
                    getFitnessActivities(subtype)
                        if app.profile is truthy
                            create a request model
                            send a GET request with the model to the api (getFitnessActivities)
                            for each item in the response object
                                get the activityTypeId
                                if subtype == activityTypeId, the push item onto qualifiedActivities array
                    getChartInfo
                        if app.profile is truthy
                            create a request model
                            if returned items exist
                                push items to progseries by looping through returned results
                                    activityAmount = 1 if goalInfo.ActivityMeasureName == null; else result[i].ActivityCheckInAmount || 0
                                    entrydate = moment(obj[i].ActivityCheckInDate).utc().valueOf();
                                    item = [ entrydate, activityAmount ]
                                measurename = basedata.chartlbl if goalinfo.ActivityMeasureName == null
                                else measurename = goalinfo.ActivityMeasureName
                                if goalinfo.DataIntervalId == "day".id
                                    datainterval = "day"
                                    dataintervallblb = basedata.chartlbl19
                                else
                                    datainterval = "week"
                                    dataintervallblb = basedata.chartlbl18
                                create a chart initialization object
                                initialize the chart with the object (activityGoalDetail)
                            else hide the chart panel
                    getFitnessGoals
                        if app.profile is truthy
                            create a request model
                            make a GET call with the request model to api (getFitnessGoalDetail)
                            if response object is truthy
                                getChartInfo()
                                set scope/view values for items displayed in the detail panel from the return object
                                if ActivityMeasureName == null, set measurename to basedata.entrieslbl
                                else set measurename to ActivityMeasureName (can do null coalesce)
                                if DateIntervalId == "day", set scope.datainterval = basedata.day; set scope.dataintervallbl = basedata.days
                                if DateIntervalId == "week", set scope.dataInterval = basedata.week; set scope.dataInterval = basedata.weeks
                                if "all activities" selected, 
                                    show control for all activities, 
                                    hide control for selected activities
                                    getFitnessActivities(subtype)
                                else
                                    hide control for all activities
                                    show control for selected activities
                        else
                            redirect to GoalsView
                    activate
                        make async calls to get array of promises
                            getFitnessGoals()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailfitness.html
            Chart panel with goal and progress
            Goal panel with details
                Goal details
                    Start goal info
                    End goal info
                    Activity to track - name, amount, data provider
                    Notes
                Edit button
                Delete button

    EDITBIOMETRIC
        controllers.goals.editbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    goalDateRange (when StartDate changed)
                        validates input date to be between min/max, or same as original date
                    evaluateDurationRange (when duration changed)
                        if date-interval-day is checked, validate duration as between 1 and 365
                        else, validate duration as between 1 and 52
                    updateMeasureParams (when measures selection is changed)
                        if event.measures is truthy
                            find the selected biometricId and biometricMeasureId in healthcategories
                                and set $scope values (amtmeasure, minrange, maxrange, decimaldigits)
                            call evaluateMeasureParams to validate
                    updateIntervalType
                        set $scope values for [...] based on selected interval type (day, week)
                            dateintervalid
                            intervaltype
                            intervaltypeplural
                        evaluateDurationRange()
                        updateMeasureParams()
                    whichMeasureSelected
                        updateMeasureParams()
                    whichDateIntervalChecked
                        * prevents user from changing date interval type (day, week)
                        sets checked attribute for 'day' as checked if 'day' radio selected and editinfo.DateIntervalId == day
                        sets checked attribute for 'week' as checked if 'week' radio selected and editinfo.DateIntervalId == week
                    doSubmit
                        create a request model
                            BiometricGoalId: from routeparams or model
                            GoalMeasureId: (was hard-coded as 2)
                            BiometricMeasureId: (get from form)
                            BiometricOpitonId: (was hard-coded as 1)
                            AggregateFunctionId: (was hard-coded as 2)
                            BiometricGoalName: get from form
                            StartDate: get from form
                            CurrentAmt: get from form
                            GoalAmt: get from form
                            DateIntervalId: scope value
                            DateIntervalCount: get from form
                            Notes: get from form
                            BiometricIds: get from form
                            BiometricTypeIds: (was hard-coded as [1])
                            AllBiometrics: (was hard-coded as false)
                        send a POST request with model to the api (updateBiometricGoal)
                        on success, return to GoalsDetailBiometric view with current goalId
                other methods
                    evaluateMeasureParams
                        return as valid if no range is defined
                        evaluate current amount (range, digits)
                        evaluate goal amount (range, digits)
                    getBiometricEditDetail
                        if app.profile is truthy and vm.editinfo is not empty []
                            set form values (models) and validation states for 
                                Measures
                                Goalname
                                StartDate
                                Duration
                                Current amount
                                Goal amount
                            update date interval labels (week, day)
                            updateIntervalType()
                            set selected activities list
                    validateGoal
                        if app.profile is truthy
                            create a request model
                            send a POST request with the request model to the api (validateHealthGoal)
                            if no exception returned, set validation as true
                            else (exception caught) set validation as false
                    setLocalAppSettings
                        if app.appsettings is truthy
                            $scope.goalmaxage = app.appsettings.goalmaxagebio
                            $scope.goalmaxfuture = app.appsettings.goalmaxfuturebio
                            initialize datepicker object values
                                startdate = $scope.goalmaxage
                                enddate = $scope.goalmaxfuture
                    loadBiometricEditDetail
                        if app.profile is truthy
                            create a request model
                            send a GET request with the model to the api
                            if return object is truthy
                                assign object to vm.editinfo
                                getBiometricEditDetail()
                            else route to GoalsView
                    getHealthCategories
                        if app.profile is truthy
                            create a request model
                            send a GET request with the model to the api (getHealthCategories)
                            if return object is truthy
                                for each item in return object
                                    create a "comkey" property in the object (BiometricId + "|" + BiometricMeasureId)
                                    if item.CanUserCreateReference && item.Enabled || item.BiometridId == $scope.biometridid (item being edited?)
                                        if !(item.CanUserCreateReference && item.Enabled)
                                            item.BiometricName += ' - Disabled'
                                        push onto temp array
                                assign temp array to vm.healthcategories
                    activate
                        make async calls to get array of promises
                            setLocalAppSettings()
                            loadBiometricEditDetail()
                            getHealthCategories()
                        activate the controller via the common module with promises and controllerId
                        set a watcher on goalname, startdate, duration to call validateGoal() when all three are not undefined
                activate()
        editbiometric.html
            Back button
            link to show help text in entry form
            Edit biometric goal panel
                Goal name - required, minlength = 3, maxlength = 100 (or 50?), unique for time frame
                Goal interval - day or week
                Start date - required, date pattern MM/dd/YYYY, min/max dates
                Duration - days (1 to 365); weeks (1 to 52)
                Biometric (e.g., Weight)
                Current amount - required, pattern, validate amount against selected biometric range, decimal digits
                Goal amount - required, pattern, validate amount against selected biometric range, decimal digits
                Notes (optional)
                biometric measure label for units changes based on the selected biometric type
            ** no Cancel button
            Submit button disabled until form validation passes

    EDITFITNESS
        controllers.goals.editfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    anyFitnessActivities(subtype, activitymeasureid)
                        foreach item in vm.fitactivities
                            if ((activityMeasureId == Entries || activityMeasureId == item.ActivityMeasureId) 
                                    && (subtype (fitness, nutrition, wellness) == acttype))
                                return true
                        return false
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    goalDateRange
                        validates input date to be between min/max, or same as original date
                    evaluateDurationRange
                        if date-interval-day is checked, validate duration as between 1 and 365
                        else validate duration as between 1 and 52
                    updateMeasureParams
                        if event.measures is >= 1
                            find the selected activityMeasureId in vm.measures
                                set $scope values (amtmeasure, minrange, maxrange, decimaldigits)
                            call evaluateMeasureParams to validate
                            getFitnessActivities(event.measures) // filter activities by measure
                        else if event.measures == -1000 ("Entries")
                            set $scope values (amtmeasure, minrange, maxrange, decimaldigits)
                        else do nothing
                    toggleSelectedActivities
                        show/hide selected activities div
                    onChangeSelectedActivities -- UNUSED
                    isSelectedActivitiesRequired
                        return !activityselecttype === 'all' (return true if activityselecttype == userselected, else return false)
                    updateIntervalType
                        set $scope values for [...] based on selected interval type (day, week)
                            dateintervalid
                            intervaltype
                            intervaltypeplural
                        evaluateDurationRange()
                        updateMeasureParams()
                    whatActivitiesSelected
                        ng-selected handler for marking an activities as selected from vm.editinfo.ActivityIds
                    whichDateIntervalChecked
                        ng-checked handler for marking the selected dateinterval as checked from vm.editinfo.DateIntervalID
                    whichMeasureSelected -- UNUSED
                    doSubmit
                        if form is valid
                            var goalMeasureId, activityMeasureId, activityIds;
                            var allActivitiesCategories = false;
                            if selected measure == 'Entries'
                                goalMeasureId = 1
                                activityMeasureId = null
                            else
                                goalMeasureId = 2
                                activityMeasureId = Number(selected measure)
                            if selected activity type = 'all'
                                activityIds = null
                                allActivitiesCategories = true
                            else
                                activityIds = selectedActivitiesList
                            create a request model
                                ActivityGoalName: get from form
                                StartDate: get from form
                                ActivityMeasureId: activityMeasureId
                                Notes: get from form
                                DateIntervalCount: get from form (duration)
                                DateIntervalId: get from scope variable
                                CurrentAmt: get from form
                                GoalAmt: get from form
                                ActivityTypeIds: [ get from route params or view model ] (as array)
                                ActivityIds: activityIds
                                AllActivities: allActivitiesCategories
                                AggregateFunctionId: 1 (hard coded)
                                GoalMeasureId: goalMeasureId
                                ActivityGoalId: get from route params or view model
                            send a POST request with the request model to the api (updateFitnessGoal)
                            on success, route back to GoalDetailFitness with goalId
                    getFitnessActivities(activityMeasureId)
                        if app.profile is truth and vm.fitactivities contains data (length >= 1)
                            initialize qualifiedActivities array
                            get subtype from route params
                            foreach item in vm.fitactivities
                                acttype = item.ActivityTypeId
                                if ((activityMeasureId == Entries || activityMeasureId == item.ActivityMeasureId) 
                                    && (subtype (fitness, nutrition, wellness) == acttype))
                                        push item to qualified activities array
                            if the result is no qualified activities, show a negative validation message
                    getFitnessEditDetails
                        if app.profile is truthy and vm.editinfo is not empty []
                            set form values (models) and validation states for 
                                Measures
                                    if vm.editinfo.ActivityMeasureId == null
                                        Measures = "Entries"
                                    else
                                        Measures = vm.editinfo.ActivityMeasureId
                                Goalname
                                StartDate
                                Duration
                                Current amount
                                Goal amount
                                Notes
                            Set selectedActivitiesList to vm.editinfo.ActivityIds
                            if vm.editinfo.AllActivities == true
                                activityselecttype = 'all
                            else
                                activityselecttype = 'userselected'
                                toggleSelectedActivities('show')
                            update date interval labels (week, day)
                            updateIntervalType()
                            if activityIds contains data (length >= 1)
                                show selected activities div
                    validateGoal
                        if app.profile is truthy
                            create a request model
                            send a POST request with the request model to the api (validateFitnessGoal)
                            if no exception returned, set validation ("unique for time") as true
                            else (exception caught) set validation as false
                other methods
                    evaluateMeasureParams
                        return as valid if no range is defined
                        evaluate current amount (range, digits)
                        evaluate goal amount (range, digits)
                    setLocalAppSettings
                        if app.appsettings is truthy
                            $scope.goalmaxage = app.appsettings.goalmaxagebio
                            $scope.goalmaxfuture = app.appsettings.goalmaxfuturebio
                            initialize datepicker object values
                                startdate = $scope.goalmaxage
                                enddate = $scope.goalmaxfuture
                    loadFitnessEditDetails
                        if app.profile is truthy
                            create a request model
                            send a GET request with the model to the api
                            if return object is truthy
                                assign object to vm.editinfo
                    getActivityMeasureMap
                        if app.profile is truthy
                            create a request model
                            send a GET request with request model to api (getActivityMeasureMap)
                            foreach returned item
                                if item.ActivityTypeId == subtype of item being edited
                                    push onto submeasures array
                            assign vm.measuremap = submeasures
                    getActivityMeasures
                        if app.profile is truthy and measuremap and fitnessactivities arrays contain data
                            create a request model
                            send a GET request with the model to the api (getActivityMeasures)
                            foreach item in measuremap
                                activitymeasureid = item.ActivityMeasureId
                                foreach obj in returned data
                                    if activitymeasureid = obj[i].ActivityMeasureId
                                        if (anyFitnessActivities(subtype, obj[x].ActivityMeasureID))
                                            push the object to the vm.measures array
                            add an item to the beginning of the vm.measures array (unshift)
                                var item = {
                                    "ActivityMeasureID": -1000,
                                    "ActivityMeasureName": basedata.entrieslbl,
                                    "MaxValue": 0,
                                    "MinValue": 0,
                                    "NumberDecimalDigits": 0
                                };
                        getFitnessEditDetails()
                    getMasterActivityList
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getFitnessActivities)
                            set vm.fitactivities = returned items
                    activate()
                        make async calls to get array of promises
                            setLocalAppSettings()
                            loadFitnessEditDetails()
                            getActivityMeasureMap()
                            getActivityMeasures()
                            getMasterActivityList()
                        activate the controller via the common module with promises and controllerId
                        set a watcher on goalname, startdate, duration to call validateGoal() when all three are not undefined
                activate()
        editfitness.html
            Back button
            link to show help text in entry form
            Edit fitness goal panel
                Goal name - required, minlength = 3, maxlength = 100 (or 50?), unique for time frame
                Goal interval - day or week
                Start date - required, date pattern MM/dd/YYYY, min/max dates
                Duration - days (1 to 365); weeks (1 to 52)
                Activity Measures (e.g., Entries, minutes, steps, times) - required, no selected activities
                Activity select type (Radio)
                    All
                    User selected
                        multi-select dropdown (hidden/disabled if All selected)
                View Activities List (link to open modal)
                Current amount - required, pattern, validate amount against selected biometric range, decimal digits
                Goal amount - required, pattern, validate amount against selected biometric range, decimal digits
                Notes (optional)
                Fitness measure label for current and goal changes based on the selected activity measure
            ** no Cancel button
            Submit button disabled until form validation passes

    FORMS (Goals tab, Create button)
        controllers.goals.forms.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                event handlers
                    gotoForm
                        routes to GoalsNewFitness (with subtype Fitness, Nutrition, Wellness) or GoalsNewBiometric
                other methods
                    activate
                        activate the controller via the common module with controllerId
                activate()
        forms.html
            Displays four goal categories: fitness, nutition, wellness, biometric
            Select button (with click handlers) and description for each category

    NEWBIOMETRIC (Goals tab, Create button, Biometric subbutton)
        controllers.goals.newbiometric.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    goalDateRange
                        validates the date entered against the allowable daterange (goalmaxage, goalmaxfuture)
                        inputdate is between mindate/maxdate (inclusive)
                    evaluateDurationRange (when duration changed)
                        if date-interval-day is checked, validate duration as between 1 and 365
                        else, validate duration as between 1 and 52
                    updateMeasureParams (when measures selection is changed)
                        if event.measures is truthy
                            find the selected biometricId and biometricMeasureId in healthcategories
                                and set $scope values (amtmeasure, minrange, maxrange, decimaldigits)
                            call evaluateMeasureParams to validate
                    evaluateMeasureParams
                        if no range defined
                            return that customrange is valid (true) for both current amount and goal amount
                        else
                            if current amount has changed and is not null
                                if current amount is within minrange and maxrange (inclusive)
                                    set current amount customrange validity = true
                                else
                                    set current amount customrange validity = false
                                if current amount has digits after the decimal point
                                    if digits after the decimal is greater than allowed
                                        set current amount customdigits validity = true
                                    else
                                        set current amount customdigits validity = false
                                else
                                    set current amount customdigits validity = true
                            if goal amount has changed and is not null
                                if goal amount is within minrange and maxrange (inclusive)
                                    set goal amount customrange validity = true
                                else
                                    set goal amount customrange validity = false
                                if goal amount has digits after the decimal point
                                    if digits after the decimal is greater than allowed
                                        set goal amount customdigits validity = true
                                    else
                                        set goal amount customdigits validity = false
                                else
                                    set goal amount customdigits validity = true
                    updateIntervalType
                        set $scope values for [...] based on selected interval type (day, week)
                            dateintervalid
                            intervaltype
                            intervaltypeplural
                        evaluateDurationRange()
                        updateMeasureParams()
                    doSubmit
                        if form is valid
                            create the request model
                                GoalMeasureId: 2 (hard coded)
                                BiometricMeasureId: (from selected measure)
                                BiometricOptionId: 1 (hard coded)
                                AggregateFunctionId: 2 (hard coded)
                                BiometricGoalName: get from form
                                StartDate: get from form
                                CurrentAmt: get from form
                                GoalAmt: get from form
                                DateIntervalID: get from $scope variable
                                DateIntervalCount: get from form (duration)
                                Notes: get from form
                                BiometridIds: (from selected measure)
                                BiometricTypeIds: [1] (hard coded)
                                AllBiometrics: false (hard coded)
                            send a POST request with the request model to the api (insertBiometricGoal)
                            on success, if object returned
                                route to GoalsDetailBiometric with the BiometricGoalId
                    validateGoal
                        if app.profile is truthy
                            create a request model
                            send a POST request with the request model to the api (validateHealthGoal)
                            if no exception returned, set validation as true
                            else (exception caught) set validation as false
                other methods
                    setLocalAppSettings
                        if app.appsettings is truthy
                            $scope.entrymaxage = app.appsettings.entrymaxagebio
                            $scope.goalmaxfuture = app.appsettings.goalmaxfuturebio
                            initialize datepicker object values
                                startdate = $scope.goalmaxage
                                enddate = $scope.goalmaxfuture
                    getHealthCategories
                        if app.profile is truthy
                            create a request model
                            make a GET request with the request model to the api (getHealthCategories)
                            if an object gets returned
                                add a "comkey" value to each object item
                                    comkey = item.BiometricID + '|' + item.BiometricMeasureId (not sure we will use this pattern in new tracker)
                    activate
                        make async calls to get array of promises
                            setLocalAppSettings()
                            getHealthCategories()
                        activate the controller via the common module with promises and controllerId
                        set a watcher on goalname, startdate, duration to call validateGoal() when all three are not undefined
                activate()
        newbiometric.html
            Back button (or link)
            Help link
            Create biometric panel
                Goal name
                Interval selector (day, week)
                Start date
                Duration
                Biometric measure
                Current amount
                Goal amount
                Notes (optional)
            Save button

    NEWFITNESS (Goals tab, Create button, Fitness/Nutrition/Wellness subbutton)
        controllers.goals.newfitness.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                    isSelectedActivitiesRequired
                        return !activityselecttype === 'all' (return true if activityselecttype == userselected, else return false)
                        ** or using jQuery -- $('#selectedactivities :checked)
                    anyFitnessActivities(subtype, activitymeasureid)
                        foreach item in vm.fitactivities
                            if ((activityMeasureId == Entries || activityMeasureId == item.ActivityMeasureId) 
                                    && (subtype (fitness, nutrition, wellness) == acttype))
                                return true
                        return false
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    goalDateRange
                        validates input date to be between min/max
                    evaluateDurationRange
                        if date-interval-day is checked, validate duration.rangeDays as between 1 and 365
                        else validate duration.rangeWeeks as between 1 and 52
                    updateMeasureParams
                        if event.measures is >= 1
                            set $scope.amtmeasure = $('select[name="measures"] :selected').text();
                            find the selected activityMeasureId in vm.measures
                                set $scope values (amtmeasure, minrange, maxrange, decimaldigits)
                            evaluateMeasureParams()
                            getFitnessActivities(event.measures) // filter activities by measure
                        else if event.measures == -1000 ("Entries")
                            set $scope values (amtmeasure, minrange, maxrange, decimaldigits)
                            evaluateMeasureParams()
                            getFitnessActivities(-1000)
                        else do nothing                
                    toggleSelectedActivities
                        show/hide selected activities div
                        if 'show'
                            allActivitiesCategories = false
                            set validity for selectedActivitiesList.required = false
                            show the div
                        else
                            allactivityids = []
                            allActivitiesCategories = true
                            set validity for selectedActivitiesList.required = true
                            hide the div
                    onChangeSelectedActivities
                        sets viewmodel variable activityids = $('select[name="selectedactivitieslist"]').val() -- used for doSubmit
                    updateIntervalType
                        set $scope values for [...] based on selected interval type (day, week)
                            dateintervalid
                            intervaltype
                            intervaltypeplural
                        evaluateDurationRange()
                        updateMeasureParams()
                    doSubmit
                        if form is valid
                            var goalMeasureId, activityMeasureId
                            if selected measure == 'Entries'
                                goalMeasureId = 1
                                activityMeasureId = null
                            else
                                goalMeasureId = 2
                                activityMeasureId = Number(selected measure)
                            create a request model
                                ActivityGoalName: get from form
                                StartDate: get from form
                                ActivityMeasureId: activityMeasureId
                                Notes: get from form
                                DateIntervalCount: get from form (duration)
                                DateIntervalId: get from scope variable
                                CurrentAmt: get from form
                                GoalAmt: get from form
                                ActivityTypeIds: [ Number($routeParams.subtype) ] (as array)
                                ActivityIds: activityIds
                                AllActivities: allActivitiesCategories
                                AggregateFunctionId: 1 (hard coded)
                                GoalMeasureId: goalMeasureId
                            send a POST request with the request model to the api (insertFitnessGoal)
                            on success, route back to GoalDetailFitness with new ActivityGoalId
                    validateGoal
                        if app.profile is truthy
                            create a request model
                            send a POST request with the request model to the api (validateFitnessGoal)
                            if no exception returned, set validation for goal name.uniquefortime as true
                            else (exception caught) set validation as false
                other methods
                    evaluateMeasureParams
                        set validity as true if no minrange/maxrange defined
                        evaluate validity of current amount (range, digits)
                        evaluate validity of goal amount (range, digits)
                    getFitnessActivities(activitymeasureid)
                        if app.profile is truthy
                            initialize qualifiedActivities array
                            get subtype from route params
                            foreach item in vm.fitactivities
                                acttype = item.ActivityTypeId
                                if ((activityMeasureId == Entries || activityMeasureId == item.ActivityMeasureId) 
                                    && (subtype (fitness, nutrition, wellness) == acttype))
                                        push item to qualified activities array
                            if the result is no qualified activities, show a negative validation message
                    setLocalAppSettings
                        if app.appsettings is truthy
                            $scope.goalmaxage = app.appsettings.goalmaxageact
                            $scope.goalmaxfuture = app.appsettings.goalmaxfutureact
                            initialize datepicker object values
                                startdate = $scope.goalmaxage
                                enddate = $scope.goalmaxfuture
                    getActivityMeasureMap
                        if app.profile is truthy
                            create a request model
                            send a GET request with request model to api (getActivityMeasureMap)
                            foreach returned item
                                if item.ActivityTypeId == subtype of item being edited
                                    push onto submeasures array
                            assign vm.measuremap = submeasures
                    getActivityMeasures
                        if app.profile is truthy and measuremap and fitnessactivities arrays contain data
                            create a request model
                            send a GET request with the model to the api (getActivityMeasures)
                            foreach item in measuremap
                                activitymeasureid = item.ActivityMeasureId
                                foreach obj in returned data
                                    if activitymeasureid = obj[i].ActivityMeasureId
                                        if (anyFitnessActivities(subtype, obj[x].ActivityMeasureID))
                                            push the object to the vm.measures array
                            add an item to the beginning of the vm.measures array (unshift)
                                var item = {
                                    "ActivityMeasureID": -1000,
                                    "ActivityMeasureName": basedata.entrieslbl,
                                    "MaxValue": 0,
                                    "MinValue": 0,
                                    "NumberDecimalDigits": 0
                                };
                    getMasterActivityList
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getFitnessActivities)
                            set vm.fitactivities = returned items   
                    activate()
                        make async calls to get array of promises
                            setLocalAppSettings()
                            getActivityMeasureMap()
                            getActivityMeasures()
                            getMasterActivityList()
                        activate the controller via the common module with promises and controllerId
                        set a watcher on goalname, startdate, duration to call validateGoal() when all three are not undefined
                activate()
        newfitness.html
            Back button
            link to show help text in entry form
            Edit fitness goal panel
                Goal name - required, minlength = 3, maxlength = 100 (or 50?), unique for time frame
                Goal interval - day or week
                Start date - required, date pattern MM/dd/YYYY, min/max dates
                Duration - days (1 to 365); weeks (1 to 52)
                Activity Measures (e.g., Entries + [...] - depends on activity category) - required, no selected activities
                Activity select type (Radio)
                    All
                    Selected Activities
                        multi-select dropdown (hidden/disabled if All selected)
                View Activities List (link to open modal)
                Current amount - required, pattern, validate amount against selected biometric range, decimal digits
                Goal amount - required, pattern, validate amount against selected biometric range, decimal digits
                Notes (optional)
                Fitness measure label for current and goal changes based on the selected activity measure
            ** no Cancel button
            Submit button disabled until form validation passes

    VIEW (Goals tab, View button)
        controllers.goals.view.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                computed values
                event handlers
                    goToFitnessDetail
                        route to GoalsDetailFitness with goalId
                    goToBiometricDetail
                        route to GoalsDetailBiometric with goalId
                other methods
                    getBiometricGoals
                        if app.profile is truthy
                            create a request model
                            send a GET request with request model to the api (getBiometricGoals)
                            set vm.biometricGoals = returned data items
                    getFitnessGoals
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getFitnessGoals)
                            set vm.fitnessGoals = returned data items
                            foreach item in vm.fitnessGoals
                                switch on item.ActivityTypeId
                                    case fitness
                                        set icon class value "picon picon-fitness picon-goalsummary"
                                    case nutrition
                                        set icon class value "picon picon-nutrition picon-goalsummary"
                                    case wellness
                                        set icon class value "picon picon-wellness picon-goalsummary"
                                    default
                                        set icon class value "picon picon-goals"
                                if item.DateIntervalId = 'week'
                                    set duration = xxx 'weeks'
                                else 
                                    set duration = xxx 'days'
                                if item.ActivityMeasureName == null
                                    set item.ActivityMeasureName = 'Entries'
                    activate
                        make async calls to get array of promises
                            getBiometricGoals()
                            getFitnessGoals()
                        activate the controller via the common module with promises and controllerId
                activate()
        view.html
            Activity Goals panel
                items ordered by StartDate
                StartDate, EndDate
                Duration
                GoalAmt, ActivityMeasureName
            Biometric Goals panel
                items ordered by StartDate
                StartDate, EndDate
                Duration
                BiometricName: GoalAmt, BiometricMeasureName
            Past Activity Goals panel
                items ordered by StartDate
                StartDate, EndDate
                Duration
                GoalAmt, ActivityMeasureName
            Past Biometric Goals panel
                items ordered by StartDate
                StartDate, EndDate
                Duration
                BiometricName: GoalAmt, BiometricMeasureName

HELP
    controllers.help.js

    ACHIEVEMENTRANK
        controllers.help.achievementrank.js
        achievementrank.html

    FAQ
        controllers.help.faq.js
        faq.html

    ICONS
        controllers.help.icons.js
        icons.html

INBOX
    controllers.inbox.js

    ABOUT
        controllers.inbox.about.js
            see PropelHTML5\App\core\locale\en-US\about.js
            see PropelHTML5\App\core\locale\en-US\basedata.js
        about.html

    CREATE
        controllers.inbox.create.js
        create.html

    VIEW
        controllers.inbox.view.js
        view.html

INCLUDE
    CHANGEPASSWORD
        controllers.settings.changepassword.js
        settings.changepassword.html

    COMMUNICATION
        controllers.settings.communication.js
        settings.communication.html

    EMAIL
        controllers.settings.email.js
        settings.email.html

    MAILADDRERSS
        controllers.settings.mailaddress.js
        settings.mailaddress.html

    SECURITYQUESTIONS
        controllers.settings.securityquestions.js
        settings.securityquestions.html

    TEXTING
        controllers.settings.texting.js
        settings.texting.html

    shell.html

    TEAMCOMPETITIONS
        controllers.teams.teamcompetitions.js
            register the new controller and its dependencies on the app
            define the controller function
                get log function from common.logger
                set any default values needed for the view
                computed values
                    displayEnrollCategory(key, competition.EnrollmentId)
                        returns true if key and competition.EnrollmentId are of the same type (e.g., 'ind', enrollmentType.Individual)
                    displayAccessLevel(key, competition.AccessLevelId)
                        returns true if key and competition.AccessLevelId are of the same type (e.g., 'pri', accessLevel.Private)
                    displayFitnessType
                        create a list of all activityTypeIds for the competition (activityTypeList)
                        returns true if the key's corresponding ActivityTypeId exists in the activityTypeList
                    displayBiometricType
                        create a list of a biometricTypeIds for the competition (biometricTypeList)
                        returns true if the key's corresponding BiometricTypeId exists in the biometricTypeList
                    gotoCompetitions
                        route to CompetitionsGrid with route params
                            enrollment category = team
                            status = all
                            itemsperpage = 20
                            access level = all
                            competitioncontext = mine
                    gotoCompetitionDetail
                        route to CompetitionDetail (with competitionId)
                event handlers
                other methods
                    getTeamDetail
                        if app.profile is truthy and vm.teamtypes contains at least 1 teamtype
                            create a request model
                            send a GET request with the request model to the api (getTeamsInfo)
                            on success, if the returned object is truthy
                                set view models for display/edit 
                                    teamname
                    getTeamCompetitions
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getCompetitionMemberEntered)
                            on success, set vm.teamcompetitions to the response object
                    activate
                        make async calls to get array of promises
                            getTeamDetail()
                            getTeamCompetitions()
                        activate the controller via the common module with promises and controllerId
                activate()
        teams.teamcompetitions.html
            shown as table (ordered by Start date, limite to 3)
                Competition name (as clickable link to Competition Detail)
                Start date, End date
                Show any relevant icons
                    Enrollment category (individual, team, group)
                    Access level (private public)
                    Activity types (fitness, nutrition, wellness, biometric)
                Links (2) for "all my team competitions"

    widgetheader.html

SETTINGS
    controllers.settings.js

    AUTHPREF
        controllers.settings.authpref.js
        authpref.html

    AUTHPREFSUCCESS
        controllers.settings.authprefsuccess.js
        authprefsuccess.html

    AUTHVERIFY
        controllers.settings.authverify.js
        authverify.html

    BADGES
        controllers.settings.badges.js
        badges.html

    COMMUNICATIONS
        controllers.settings.communications.js
        communications.html

    GROUPS
        controllers.settings.groups.js
        groups.html

    PASSWORD
        controllers.settings.password.js
        password.html

    PROFILE
        controllers.settings.profile.js
        profile.html
TEAMS
    controllers.teams.js
        contains data for Teams tab buttons (View, Create, About)

    ABOUT (Teams tab, About button)
        controllers.teams.about.js
            see PropelHTML5\App\core\locale\en-US\about.js
            see PropelHTML5\App\core\locale\en-US\basedata.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any defaults needed for the view
                other methods
                    activate
                        activate the controller via the common module with controllerId
                activate()
        about.html

    ADDFAMILYMEMBERS (**Family teams are deprecated)
        controllers.teams.addfamilymembers.js
            register the new controller and its dependencies on the app
            define the controller function
                get log function from common.logger
                set any defaults needed for the view
                computed values
                    disableAddBtns
                        return vm.searchresults.length < 1
                    displayWarning
                        return vm.searchresults.length < 1
                    disableRemoveSend
                        return vm.invitationlist.length < 1
                event handlers
                    addAll
                        adds all items in searchresults (regardless of select status) to invitationlist
                        only adds items that are not already in invitationlist (prevents duplicates)
                    removeAll
                        resets invitationlist array to []
                    addSelected
                        gets ids of all selected items in searchresults
                        create an add list
                        create a copy of the invitationlist with only ids
                        if items in the add list are not currently in the invitationlist copy
                            add item to the invitationlist
                    removeSelected
                        get ids of all selected items in invitations
                        remove items using two nested loops and array.splice() function
                    gotoTeamDetail
                        routes to TeamsDetailFamilyCaptain with teamId
                    addFamilyMembers
                        handler for Add To Team button; adds all invitationlist items
                        foreach item in invitationlist
                            create a request model
                            send a POST request with the request model to the api (insertTeamMember)
                            on success
                                removeAll()
                                route to TeamsDetailFamilyCaptain with teamId
                    getRelatedMembers
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getRelatedMembers)
                            on success
                                create a tmp array of current family roster memberUids
                                create a family array that includes those which are not in roster yet
                                set vm.searchresults = family array
                other methods
                    getTeamDetail
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamDetail)
                            get first item returned (team object)
                            if return object is truthy
                                set $scope.teamname = obj.TeamName
                            else
                                route to TeamsView
                    getTeamRoster
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamRoster)
                            set vm.roster to the returned data items
                            getRelatedMembers()
                    activate
                        make async calls to get array of promises
                            getTeamDetail()
                            getTeamRoster()
                        activate the controller via the common module with promises and controllerId
                activate()          
        addfamilymembers.html
            Back button
            Select Family Members to Add to Team panel
                Related Members (multi-select)
                    Add All To List button
                    Add Selected To List button
                    (Msg) "No results found.You are not connected to any additional family members to add to your family team."
                Individuals to Add (multi-select)
                    Remove Selected button
                    Clear List button
                Done button
                Add To Team button
            {Team Name} Team Roster panel
                Member name (first, last, displayname)
                Contact member link
                Status (confirmed, declined, etc)

    DETAILFAMILYCAPTAIN (**Family teams are deprecated)
        controllers.teams.detailfamilycaptain.js
            register the new controller and its dependencies on the app
            define the controller function
                get log function from common.logger
                set any defaults needed for the view
                computed values
                    showRemoveMember
                        return true if the roster memberUid is not the logged in user memberUid
                event handlers
                    goToAddFamilyMembers
                        route to TeamsAddFamilyMembers with teamId
                    goToEdit
                        route to TeamsEditForm with teamId
                    deleteTeam
                        hide the deleteConfirmation modal
                        when hidden event fires, route to TeamsView
                        doDeleteTeam(teamId)
                    prepRemoveMember
                        set removememberuid = id
                        show the removeTeamMember modal
                    removeMember
                        if the removememberuid has a valid value (>= '00000000-0000-0000-0000-000000000000')
                            create a request model
                            send a DELETE request with the request model to the api (deleteTeamMember)
                            on success, reset removememberuid (-1)
                            getTeamRoster()
                    getTeamRoster
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamRoster)
                            on success
                                set the vm.roster to the returned data items
                other methods
                    doDeleteTeam
                        if app.profile is truthy
                            create a request model
                            send a DELETE request with the request model to the api (deleteTeam)
                    getTeamDetail
                        if app.profile is truthy and vm.teamtypes contains at least 1 teamtype
                            create a request model
                            send a GET request with the request model to the api (getTeamDetail)
                            on success, if the returned object is truthy
                                verify user is team captain
                                    if app.profile.MemberUid != returnObj.OwnerUid
                                        route back to TeamsView
                                    set view models for display/edit 
                                        teamname
                                        teamtype
                                        teamdescription
                                    set teamTypeDescription from return object (match with vm.teamtypes on TeamTypeId)
                                    getTeamRoster()
                    getTeamTypes
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamTypes)
                            on success, set vm.teamtypes = result items                        
                    activate
                        make async calls to get array of promises
                            getTeamDetail()
                            getTeamTypes()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailfamilycaptain.html
            Back button
            Team details panel
                Team name
                Team description
                Edit button
                Delete button
            Competitions panel (/App/layout/include/teams.teamcompetitions.html)
            Roster panel
                Achievement rank (if any)
                Name (first, last, displayname)
                Contact member link/button
                Status
                Remove?
                Add Team Members button
                Send Team Message button
            Modals
                Delete team confirmation (cancel, delete)
                Remove team member (cancel, remove)
                Send team message (where is this modal located?)
                    Subject
                    Message
                    Cancel button
                    Send button

    DETAILFAMILYMEMBER (**Family teams are deprecated)
        controllers.teams.detailfamilymember.js
        detailfamilymember.html

    DETAILSTANDARDCAPTAIN
        controllers.teams.detailstandardcaptain.js
            register the new controller and its dependencies on the app
            define the controller function
                get log function from common.logger
                set any defaults needed for the view
                computed values
                    showRemoveMember
                        return true if the roster memberUid is not the logged in user memberUid
                event handlers
                    goToEdit
                        route to TeamsEditForm with teamId
                    deleteTeam
                        hide the deleteConfirmation modal
                        when hidden event fires, route to TeamsView
                        doDeleteTeam(teamId)
                    goToInviteMembers
                        route to TeamsInviteMembers with teamId
                    prepRemoveMember
                        set removememberuid = id
                        show the removeTeamMember modal
                    removeMember
                        if the removememberuid has a valid value (>= '00000000-0000-0000-0000-000000000000')
                            create a request model
                            send a DELETE request with the request model to the api (deleteTeamMember)
                            on success, reset removememberuid (-1)
                            getTeamRoster()
                    getTeamRoster
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamRoster)
                            on success
                                set the vm.roster to the returned data items
                                create eligiblecaptains array by pushing the rosterItems where 
                                    rosterItem.ConfirmationStatusId == confirmed and rosterItem.IsOwner is false
                    changeTeamCaptain
                        if form is valid
                            create a request model
                            send a POST request with the request model to the api (changeTeamCaptain)
                            on success, route back to TeamsView
                other methods
                    doDeleteTeam
                        if app.profile is truthy
                            create a request model
                            send a DELETE request with the request model to the api (deleteTeam)
                    getTeamDetail
                        if app.profile is truthy and vm.teamtypes contains at least 1 teamtype
                            create a request model
                            send a GET request with the request model to the api (getTeamDetail)
                            on success, if the returned object is truthy
                                verify user is team captain
                                    if app.profile.MemberUid != returnObj.OwnerUid
                                        route back to TeamsView
                                    set view models for display/edit 
                                        teamname
                                        teamtype
                                        teamdescription
                                    set teamTypeDescription from return object (match with vm.teamtypes on TeamTypeId)
                                    getTeamRoster()
                    getTeamTypes
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamTypes)
                            on success, set vm.teamtypes = result items                        
                    activate
                        make async calls to get array of promises
                            getTeamDetail()
                            getTeamTypes()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailstandardcaptain.html
            Back button
            Team details panel
                Team name
                Team description
                Edit button
                Delete button
            Competitions panel (/App/layout/include/teams.teamcompetitions.html)
            Roster panel
                Achievement rank (if any)
                Name (first, last, displayname)
                Contact member link/button
                Status
                Remove?
                Invite Members button
                Change Captain button
                Send Team Message button
            Modals
                Delete team confirmation (cancel, delete)
                Remove team member (cancel, remove)
                Change captain (select captain dropdown, cancel, save)
                Send team message (where is this modal located?)
                    Subject
                    Message
                    Cancel button
                    Send button

    DETAILSTANDARDINVITE
        controllers.teams.detailstandardinvite.js
            register the new controller and its dependencies on the app
            define the controller function
                get log function from common.logger
                set any defaults needed for the view
                computed values
                event handlers
                    doInvitation(action)
                        switch on action
                            'accept' - set confirmationstatusid = confirmed
                            'decline' - set confirmationstatusid = declined
                        create a request model
                        send a POST request with the request model to the api (updateTeamMember)
                        on success
                            if confirmationstatusid == confirmed
                                route to TeamsDetailStandardMember with teamId
                            else
                                route to TeamsView
                other methods
                    getTeamDetail
                        if app.profile is truthy and vm.teamtypes contains at least 1 teamtype
                            create a request model
                            send a GET request with the request model to the api (getTeamDetail)
                            on success, if the returned object is truthy
                                set scope variables for display
                                    teamname
                                    teamtype
                                    teamdesc
                                    set teamtypedesc on matching item from vm.teamtypes
                            else route to TeamsView
                    getTeamTypes
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamTypes)
                            on success, set vm.teamtypes = result items                        
                    getTeamRoster
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamRoster)
                            on success
                                set obj to returned data items
                                if obj is truthy
                                    push to vm.roster those items where ConfirmationStatusId != declined
                    activate
                        make async calls to get array of promises
                            getTeamTypes()
                            getTeamDetail()
                            getTeamRoster()
                        activate the controller via the common module with promises and controllerId
                activate()
        detailstandardinvite.html
            Back button
            Team Details panel
                Team name
                Description
                    Team type description
                    Team description
            Invitation - {TeamName} panel
                Accept Invitation button
                Decline Invitation button
            {TeamName} Roster panel
                show achievement rank (if any)
                Name (first, last, displayname)
                Send Message link
                Status (confirmed, pending, declined)

    DETAILSTANDARDMEMBER
        controllers.teams.detailstandardmember.js
            register the new controller and its dependencies on the app
            define the controller function
                get log function from common.logger
                set any defaults needed for the view
                computed values
                event handlers
                    leaveTeam
                        hide the leaveTeamConfirmation modal
                        when hidden event fires, route to TeamsView
                        doLeaveTeam(teamId)
                other methods
                    doLeaveTeam
                        if app.profile is truthy
                            create a request model
                            send a DELETE request with the request model to the api (deleteTeamMember)
                    getTeamDetail
                        if app.profile is truthy and vm.teamtypes contains at least 1 teamtype
                            create a request model
                            send a GET request with the request model to the api (getTeamDetail)
                            on success, if the returned object is truthy
                                verify user is team captain
                                    if app.profile.MemberUid != returnObj.OwnerUid
                                        route back to TeamsView
                                    set view models for display/edit 
                                        teamname
                                        teamtype
                                        teamdescription
                                    set teamTypeDescription from return object (match with vm.teamtypes on TeamTypeId)
                                    getTeamRoster()
                            else route to TeamsView
                    getTeamTypes
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamTypes)
                            on success, set vm.teamtypes = result items                        
                    getTeamRoster
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamRoster)
                            on success
                                set obj to returned data items
                                if obj is truthy
                                    push to vm.roster those items where ConfirmationStatusId != declined
                    activate
                        make async calls to get array of promises
                            getTeamTypes()
                            getTeamDetail()
                            getTeamRoster()
                        activate the controller via the common module with promises and controllerId
                activate()        
        detailstandardmember.html
            Back button
            Team details panel
                Team name
                Team description
            Competitions panel (/App/layout/include/teams.teamcompetitions.html)
            Roster panel
                Achievement rank (if any)
                Name (first, last, displayname)
                Contact member link/button
                Status
                Leave Team button
                Send Team Message button
            Modals
                Leave Team confirmation (cancel, delete)
                Send team message (where is this modal located?)
                    Subject
                    Message
                    Cancel button
                    Send button

    EDITFORM
        controllers.teams.editform.js
            register the new controller and its dependencies on the app
            define the controller function
                get the login function from common.logger
            set default values needed for the view
            computed values
            event handlers
                checkMaxLength
                    IE workaround on textarea maxlength (will we continue to support this for IE?)
                doSubmit
                    if form is valid
                        create a request model
                        send a POST request with the request model to the api (updateTeam)
                        on success, returns the resulting teamId
                        if teamType = standard
                            route to TeamsInviteMembers with teamId
                        else if teamType = family
                            route to TeamsAddFamilyMembers with teamId
            other methods
                getTeamTypes
                    if app.api is truthy
                        create a request model
                        send a GET request with the request model to the api (getTeamTypes)
                        on success, set vm.teamtypes = result items
                getTeamDetail
                    if app.profile is truthy and vm.teamtypes contains at least 1 teamtype
                        create a request model
                        send a GET request with the request model to the api (getTeamsInfo)
                        on success, if the returned object is truthy
                            set view models for display/edit 
                                teamname
                                teamtype
                                teamdescription
                            set teamTypeDescription from return object (match with vm.teamtypes on TeamTypeId)
                activate
                    make async calls to get array of promises
                        getTeamTypes()
                        getTeamDetail()
                    activate the controller via the common module with the promises and controllerId
            activate()
        editform.html
            Back button
            Help link
            Edit Team panel
                Team name (required, minlength = 3, maxlength = 100)
                Team type (not editable)
                Team description (optional)
            Save button (disabled until form is valid)

    INVITEMEMBERS
        controllers.teams.invitemembers.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set default values needed for the view
                computed values
                    disableAddBtns
                        return vm.searchresults.length < 1
                    disableRemoveSend
                        return vm.invitationlist.length < 1
                    isNameRequired
                        if 'All Groups" selected
                            return true
                        else
                            if group member search allowed without member query (check configuration)
                                return true
                            else
                                return false
                    isGroupRequired
                        if no names are entered
                            return true
                        else
                            return false (currently there is no configuration to indicate whether a group member search is allowed without group query)                            
                event handlers
                    doSearch
                        if form is valid
                            if namesearch has a value and groupsearch is "All Groups"
                                searchMembers(namesearch)
                            if namesearch is empty and a group is selected
                                searchGroup(groupid: groupsearch, membername: null)
                            if namesearch has a value and a group is selected
                                searchGroup(groupid: groupsearch, membername: namesearch)
                    addAll
                        adds all items in searchresults (regardless of select status) to invitationlist
                        only adds items that are not already in invitationlist (prevents duplicates)
                    removeAll
                        resets invitationlist array to []
                    addSelected
                        gets ids of all selected items in searchresults
                        create an add list
                        create a copy of the invitationlist with only ids
                        if items in the add list are not currently in the invitationlist copy
                            add item to the invitationlist
                    removeSelected
                        get ids of all selected items in invitations
                        remove items using two nested loops and array.splice() function
                    gotoTeamDetail
                        routes to TeamsDetailStandardCaptain with teamId
                    sendInvitations
                        show "isBusy" modal
                        create an array of ids (includeMembers) from invitationlist where the id is not current in the team list
                        create a request model
                        send a POST request with the request model to the api (updateTeamMemberSelectMember)
                        on success
                            getTeamRoster()
                            $scope.removeAll()
                            hide "isBusy" modal
                other methods
                    searchMembers(membername)
                        if membername is truthy
                            create a request model
                            initialize vm.searchresults array
                            send a GET request with the request model to the api (searchMembers)
                            on success
                                if returned data items are truthy
                                    push all items onto vm.searchresults where item.MemberUid is not currently in vm.rosterids
                    searchGroup(groupid, membername)
                        if groupid is truthy
                            create a request model
                            initialize vm.searchresults array
                            send a GET request with the request model to the api (searchGroupMembers)
                            on success
                                if returned data items are truthy
                                    push all items onto vm.searchresults where item.MemberUid is not currently in vm.rosterids
                    setLocalAppSettings
                        if app.appSettings is truthy
                            set local scope variable searchGrpMbrNoMbrQry = app.appSettings.searchGrpMbrNoMbrQry
                    getTeamDetail
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamDetail)
                            on success
                                if the returned object is truthy
                                    set view models for display/edit 
                                        teamname
                                else
                                    route to TeamsView
                    getTeamRoster
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamRoster)
                            set vm.roster to the returned data items
                            push all MemberUids onto vm.rosterids
                    getGroups
                        if app.profile is truthy
                            create a request model
                                send a GET request with the request model to the api (searchGroups)
                                on success, set vm.options to the returned data items
                    activate
                        make async calls to get array of promises
                            setLocalAppSettings()
                            getTeamDetail()
                            getTeamRoster()
                            getGroups()
                        activate the controller via the common module with promises and controllerId
                activate()
        invitemembers.html
            Back button
            Find Members to Invite panel
                Search by name input
                Search by group dropdown list
                Search button
                Search results (multi-select)
                    Add All To List button
                    Add Selected To List button
                Invitation list (multi-select)
                    Remove Selected button
                    Clear List button
                Done button
                Send Invitations button
            {Team Name} Roster panel
                Show achievement rank (if applicable)
                Member name (first, last, displayname)
                Contact member link
                Status (confirmed, declined, etc)

    NEWFORM (Teams tab, Create button)
        controllers.teams.newform.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set default values needed for the view
                computed values
                event handlers
                    checkMaxLength
                        IE workaround on textarea maxlength (will we continue to support this for IE?)
                    doSubmit
                        if form is valid
                            create a request model
                            send a POST request with the request model to the api (insertTeam)
                            on success, returns the resulting teamId
                            if teamType = standard
                                route to TeamsInviteMembers with teamId
                            else if teamType = family
                                route to TeamsAddFamilyMembers with teamId
                other methods
                    getTeamTypes
                        if app.api is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamTypes)
                            on success, set vm.options = result items
                    activate
                        make async calls to get array of promises
                            getTeamTypes()
                        activate the controller via the common module with promises and controllerId
                activate()
        newform.html
            Show help link
            Panel to create new team
                Team name (required, minlength = 3, maxlength = 100)
                Team type (required)
                Team description (optional)
            Save button (disabled until form is valid)

    VIEW (Teams tab, View button)
        controllers.teams.view.js
            register the new controller and its dependencies on the app
            define the controller function
                get the log function from common.logger
                set any default values needed for the view
                    Pagination settings, etc.
                computed values
                    displayEnrollCategory(key, competition.EnrollmentId)
                        returns true if key and competition.EnrollmentId are of the same type (e.g., 'ind', enrollmentType.Individual)
                    displayAccessLevel(key, competition.AccessLevelId)
                        returns true if key and competition.AccessLevelId are of the same type (e.g., 'pri', accessLevel.Private)
                    displayFitnessType
                        create a list of all activityTypeIds for the competition (activityTypeList)
                        returns true if the key's corresponding ActivityTypeId exists in the activityTypeList
                    displayBiometricType
                        create a list of a biometricTypeIds for the competition (biometricTypeList)
                        returns true if the key's corresponding BiometricTypeId exists in the biometricTypeList
                event handlers
                    gotoTeamDetail
                        sets teamType to 'standard' or 'family'
                        sets memberType to 'captain' or 'member'
                        sets context to teamType + '-' + memberType
                        switch on context
                            case familyTeamType + captainMemberType
                                route to TeamsDetailFamilyCaptain (with TeamId)
                            case familyTeamType + memberMemberType
                                route to TeamsDetailFamilyMember (with TeamId)
                            case standardTeamType + captainMemberType
                                route to TeamsDetailStandardCaptain (with TeamId)
                            case standardTeamType + memberMemberType
                                route to TeamsDetailStandardMember (with TeamId)
                    gotoInvitation
                        route to TeamsDetailStandardInvite (with TeamId)
                    gotoCompetitions
                        route to CompetitionsGrid with route params
                            enrollment category = team
                            status = all
                            itemsperpage = 20
                            access level = public
                            competitioncontext = open
                    gotoCompetitionDetail
                        route to CompetitionDetail (with competitionId)
                    getMyTeams
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getMyTeams)
                            on success, create a list of my team ids (myTeamsList)
                            if vm.teamsinfo[i].TeamId exists in myTeamsList
                                push vm.teamsinfo[i] onto vm.myTeams
                            set pagination numberOfPages
                    getInvitations
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamInvitations)
                            on success, set vm.invitations to the response object
                other methods
                    getTeamsInfo
                        if app.profile is truthy
                            create a request model
                            send a GET with the request model to the api (getMyTeamsDetails)
                            on success, set vm.teamsinfo to the response object
                            getMyTeams()
                            getInvitations()
                    getTeamCompetitions
                        if app.profile is truthy
                            create a request model
                            send a GET request with the request model to the api (getTeamCompetitions)
                            on success, set vm.teamcompetitions to the response object
                    activate
                        make async calls to get array of promises
                            getTeamsInfo()
                            getTeamCompetitions()
                        activate the controller via the common module with promises and controllerId
                activate()
        view.html
            My Teams panel
                Title + number of teams
                "No items" panel (show if no items)
                Shown as table with pagination
                On click, go to team detail view
                Team name
                Captain (first, last, displayname)
                Member count
                Show pagination panel if pages > 1
            Invitations panel (show if invitations > 0)
                Shown as table
                On click, go to invitation page
                Team name
                Captain (first, last, displayname)
                Member count
            Available Team Competitions panel
                Panel title (clickable, go to competitions)
                Panel body (show if any new public team competitions available)
                    order by StartDate, limit to 4
                    Competitions show as table
                        StartDate - EndDate
                        Show a corresponding icon based on enrollment category, access level, fitness type, or biometric type
                Panel footer
                    View All Available Team Competitions (clickable)